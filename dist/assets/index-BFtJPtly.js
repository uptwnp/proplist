import{c as kt,j as e}from"./utils-B-OgwuqA.js";import{a as Pt,r as y,R as St}from"./vendor-wpXbf5jk.js";import{M as rt,m as at,N as nt,S as ot,L as ze,a as Me,P as Ct}from"./map-Bm3KrxaF.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();var it,Ke=Pt;it=Ke.createRoot,Ke.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Lt={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),M=(t,r)=>{const s=y.forwardRef(({color:a="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:c="",children:x,...u},g)=>y.createElement("svg",{ref:g,...Lt,width:n,height:n,stroke:a,strokeWidth:l?Number(i)*24/Number(n):i,className:["lucide",`lucide-${zt(t)}`,c].join(" "),...u},[...r.map(([h,L])=>y.createElement(h,L)),...Array.isArray(x)?x:[x]]));return s.displayName=`${t}`,s};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=M("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=M("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=M("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=M("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=M("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=M("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=M("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=M("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=M("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=M("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=M("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=M("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=M("Factory",[["path",{d:"M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"159hny"}],["path",{d:"M17 18h1",key:"uldtlt"}],["path",{d:"M12 18h1",key:"s9uhes"}],["path",{d:"M7 18h1",key:"1neino"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=M("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=M("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=M("IndianRupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=M("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=M("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=M("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=M("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=M("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=M("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=M("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=M("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=M("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=M("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=M("Mouse",[["rect",{x:"5",y:"2",width:"14",height:"20",rx:"7",key:"11ol66"}],["path",{d:"M12 6v4",key:"16clxf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=M("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=M("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=M("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=M("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=M("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=M("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=M("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=M("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=M("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=M("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=M("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=M("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=M("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=M("TreePine",[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=M("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=M("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=M("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=M("Wheat",[["path",{d:"M2 22 16 8",key:"60hf96"}],["path",{d:"M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1rdhi6"}],["path",{d:"M7.47 8.53 9 7l1.53 1.53a3.5 3.5 0 0 1 0 4.94L9 15l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1sdzmb"}],["path",{d:"M11.47 4.53 13 3l1.53 1.53a3.5 3.5 0 0 1 0 4.94L13 11l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"eoatbi"}],["path",{d:"M20 2h2v2a4 4 0 0 1-4 4h-2V6a4 4 0 0 1 4-4Z",key:"19rau1"}],["path",{d:"M11.47 17.47 13 19l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L5 19l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"tc8ph9"}],["path",{d:"M15.47 13.47 17 15l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L9 15l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"2m8kc5"}],["path",{d:"M19.47 9.47 21 11l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L13 11l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"vex3ng"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=M("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=M("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),pt=["Plot Residential","Shop","House","Colony","Flats","Agriculture Land","Free Zone Land","Godown","Factory","Big Commercial","Plot Industrial","Other"],ht=["Owner","Dealer","Developer","Affiliate","Padosi","Devloper","Other Related"],Qt=["Owner","Dealer","Developer","Affiliate","Padosi","Devloper","Other Related"],Jt=["Website","Social Media","Document","Image","Video","Map","Other"],Kt=["corner plot","main road","gated community","near hospital","near market","water supply","electricity","park facing","east facing","west facing","prime location"],Yt={"Plot Residential":"#2563EB",Shop:"#059669",House:"#7C3AED",Colony:"#DC2626",Flats:"#EA580C","Agriculture Land":"#65A30D","Free Zone Land":"#0891B2",Godown:"#6B7280",Factory:"#991B1B","Big Commercial":"#16A34A","Plot Industrial":"#92400E",Other:"#4B5563"},gt=[1,2,3,4,5],Ge=["Modal Town","Sat Kartar","Sondhapur","Sodhapur","Kabri Road","Sector 24","Babail Road","Kutani Road","Tehsil Camp","Devi Mandir Road","Sector 7 Side","Sector 13 - 17","Toll Side","Nangal Kheri","Outer Sanoli Road","Outer Delhi Road","Outer Karnal Road","Outer Jind Road Road","Other","Outside Panipat"],q={latitude:29.3864726,longitude:76.9956668},Xt=[[0,30],[30,60],[60,90],[90,120],[120,150],[150,200],[200,250],[250,300],[300,400],[400,500],[500,1e3],[1e3,1e5]],es=[[0,50],[50,100],[100,150],[150,200],[200,300],[300,500],[500,1e3],[1e3,5e3]],ts=[[0,0],[1,100],[100,500],[500,1e3],[1e3,2e3],[2e3,5e3],[5e3,1e4],[1e4,2e4],[2e4,5e4]],ss=[{value:"newest",label:"Newest First"},{value:"oldest",label:"Oldest First"},{value:"price_asc",label:"Price: Low to High"},{value:"price_desc",label:"Price: High to Low"},{value:"size_asc",label:"Size: Small to Large"},{value:"size_desc",label:"Size: Large to Small"},{value:"rating_desc",label:"Highest Rated"}],K={defaultZoom:12,focusZoom:16,detailZoom:16,minZoom:8,maxZoom:18,satelliteUrl:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",streetUrl:"https://tile.openstreetmap.org/{z}/{x}/{y}.png"},D={baseUrl:"https://prop.digiheadway.in/api/v3/listing/index.php",tables:{properties:"v3_properties",persons:"v3_person",connections:"v3_connections",links:"v3_links"}},rs={property:{area:"Enter area/address details",description:"Gali Width, Per Gaj, Dimensions, Facing, Legal",notes:"Add any additional notes",tags:"Type to search or add new tag...",zone:"Select zone type"},person:{name:"Enter full name",phone:"Enter phone number",alternativeContact:"Enter alternative contact",about:"Add details about this person"},link:{url:"Enter URL (https://example.com)",anchor:"Enter display text (optional)",type:"Select link type"},search:{properties:"Search by area, zone...",persons:"Search by name, phone...",selectPerson:"Search by name or phone...",tags:"Search tags...",location:"Search for a location..."}},H={loadProperties:"Failed to load properties",loadPersons:"Failed to load persons",loadConnections:"Failed to load connections",loadLinks:"Failed to load links",createProperty:"Failed to create property",updateProperty:"Failed to update property",deleteProperty:"Failed to delete property",createPerson:"Failed to create person",updatePerson:"Failed to update person",deletePerson:"Failed to delete person",createConnection:"Failed to create connection",deleteConnection:"Failed to delete connection",createLink:"Failed to create link",updateLink:"Failed to update link",deleteLink:"Failed to delete link",gpsNotSupported:"GPS is not supported in your browser",gpsError:"Unable to get your location. Please check your GPS settings and try again.",invalidCoordinates:"Invalid coordinates provided",geocodingError:"Unable to find location. Please try a different search term."},v={buttons:{add:"Add",edit:"Edit",delete:"Delete",save:"Save",cancel:"Cancel",confirm:"Confirm",retry:"Retry",close:"Close",apply:"Apply",reset:"Reset all",showRange:"Show range",hideRange:"Hide range",addProperty:"Add Property",addPerson:"Add Person",addLink:"Add Link",editProperty:"Edit Property",editPerson:"Edit Person",editLink:"Edit Link",updateProperty:"Update Property",updatePerson:"Update Person",updateLink:"Update Link",deleteProperty:"Delete Property",deletePerson:"Delete Person",deleteLink:"Delete Link",connectPerson:"Connect Person",addNewPerson:"Add New Person",selectPerson:"Select Person",updateLocation:"Update Location",useCurrentLocation:"Use current location",openInMaps:"Open in Google Maps",manageTags:"Manage Tags",addTag:"Add Tag",editTag:"Edit Tag",deleteTag:"Delete Tag",createTag:"Create Tag",updateTag:"Update Tag",searchLocation:"Search Location"},labels:{properties:"Properties",persons:"Persons",links:"Links",filters:"Filters",propertyDetails:"Property Details",contactPersons:"Contact Persons",connectedProperties:"Connected Properties",locationCoverage:"Location & Coverage",coordinates:"Coordinates",coverageRadius:"Coverage Radius",propertyType:"Property Type",propertyTypes:"Property Types",size:"Size",price:"Price",priceRange:"Price Range",sizeRange:"Size (sq yd)",area:"Area/Address",description:"Description",notes:"Notes",tags:"Tags",includeTags:"Include Tags",excludeTags:"Exclude Tags",zone:"Zone",name:"Name",phone:"Phone",alternativeContact:"Alternative Contact",role:"Role",about:"About",hasProperties:"Has Properties",roleInProperty:"Role in Property",remarks:"Remarks (Optional)",rating:"Rating",tagName:"Tag Name",availableTags:"Available Tags",selectedTags:"Selected Tags",sortBy:"Sort By",url:"URL",linkType:"Link Type",displayText:"Display Text",resourceLinks:"Resource Links",hasLocation:"Location Status",radiusRange:"Coverage Radius"},placeholders:rs,noData:{properties:"No properties found matching your criteria.",persons:"No persons found matching your criteria.",links:"No links added yet.",searchResults:"No persons found matching your search",contactPersons:"No contact persons available",addSomeone:"Add someone to get started",noTags:"No tags available",noSelectedTags:"No tags selected"}},bt=t=>!t||typeof t.latitude!="number"||typeof t.longitude!="number"||isNaN(t.latitude)||isNaN(t.longitude)?q:t;async function Q(t,r={}){const s=new URL(D.baseUrl);s.searchParams.append("table",t),Object.entries(r).forEach(([a,n])=>{n!=null&&n!==""&&s.searchParams.append(a,String(n))});try{const a=await fetch(s.toString(),{method:"GET",headers:{"Content-Type":"application/json"}});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const n=await a.json();if(n.error)throw new Error(n.error);return n.data||[]}catch(a){throw console.error("Fetch error:",a),a}}async function Ae(t,r){const s=new URL(D.baseUrl);s.searchParams.append("table",t);try{const a=await fetch(s.toString(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const n=await a.json();if(n.error)throw new Error(n.error);return n}catch(a){throw console.error("Post error:",a),a}}async function Re(t,r){const s=new URL(D.baseUrl);s.searchParams.append("table",t);try{const a=await fetch(s.toString(),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const n=await a.json();if(n.error)throw new Error(n.error);return n}catch(a){throw console.error("Put error:",a),a}}async function ie(t,r){const s=new URL(D.baseUrl);s.searchParams.append("table",t);try{const a=await fetch(s.toString(),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:r})});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const n=await a.json();if(n.error)throw new Error(n.error);return n}catch(a){throw console.error("Delete error:",a),a}}function et(t){const r=bt(t.location);return{...t,tags:Array.isArray(t.tags)?t.tags.join(","):t.tags,location:`${r.latitude},${r.longitude}`,rating:t.rating||0,created_on:void 0,updated_on:void 0}}function $e(t){return{...t,id:Number(t.id),tags:typeof t.tags=="string"?t.tags.split(",").filter(Boolean):Array.isArray(t.tags)?t.tags:[],location:typeof t.location=="string"?(()=>{const r=t.location.split(","),s=parseFloat(r[0]),a=parseFloat(r[1]);return isNaN(s)||isNaN(a)?q:{latitude:s,longitude:a}})():bt(t.location),size_min:Number(t.size_min)||0,size_max:Number(t.size_max)||0,price_min:Number(t.price_min)||0,price_max:Number(t.price_max)||0,radius:Number(t.radius)||0,rating:Number(t.rating)||0}}const ke={getAll:async(t={})=>(await Q(D.tables.properties,t)).map($e),getById:async t=>{const r=await Q(D.tables.properties,{id:t});return $e(r[0])},create:async t=>{const r=et(t);return delete r.id,Ae(D.tables.properties,r)},update:async t=>{const r=et(t);return Re(D.tables.properties,r)},delete:t=>ie(D.tables.properties,t),search:async(t,r={})=>(await Q(D.tables.properties,{...r,area:t})).map($e)},Pe={getAll:async(t={})=>(await Q(D.tables.persons,t)).map(s=>({...s,id:Number(s.id),alternative_contact:s.alternative_contact_details})),getById:async t=>{const s=(await Q(D.tables.persons,{id:t}))[0];return{...s,id:Number(s.id),alternative_contact:s.alternative_contact_details}},create:t=>Ae(D.tables.persons,{...t,alternative_contact_details:t.alternative_contact}),update:t=>Re(D.tables.persons,{...t,alternative_contact_details:t.alternative_contact}),delete:t=>ie(D.tables.persons,t),search:async t=>(await Q(D.tables.persons,{name:t})).map(s=>({...s,id:Number(s.id),alternative_contact:s.alternative_contact_details}))},Oe={getAll:async(t={})=>(await Q(D.tables.connections,t)).map(s=>({...s,id:Number(s.id),property_id:Number(s.property_id),person_id:Number(s.person_id)})),getByPropertyId:async t=>(await Q(D.tables.connections,{property_id:t})).map(s=>({...s,id:Number(s.id),property_id:Number(s.property_id),person_id:Number(s.person_id)})),getByPersonId:async t=>(await Q(D.tables.connections,{person_id:t})).map(s=>({...s,id:Number(s.id),property_id:Number(s.property_id),person_id:Number(s.person_id)})),create:t=>Ae(D.tables.connections,t),update:t=>Re(D.tables.connections,t),delete:t=>ie(D.tables.connections,t),deleteByPropertyId:async t=>{try{const r=await Q(D.tables.connections,{property_id:t});return await Promise.all(r.map(s=>ie(D.tables.connections,Number(s.id)))),{success:!0}}catch(r){return console.error("Error deleting connections by property ID:",r),{success:!1}}},deleteByPersonId:async t=>{try{const r=await Q(D.tables.connections,{person_id:t});return await Promise.all(r.map(s=>ie(D.tables.connections,Number(s.id)))),{success:!0}}catch(r){return console.error("Error deleting connections by person ID:",r),{success:!1}}}},Se={getAll:async(t={})=>(await Q(D.tables.links,t)).map(s=>({...s,id:Number(s.id),property_id:Number(s.property_id)})),getByPropertyId:async t=>(await Q(D.tables.links,{property_id:t})).map(s=>({...s,id:Number(s.id),property_id:Number(s.property_id)})),create:t=>Ae(D.tables.links,t),update:t=>Re(D.tables.links,t),delete:t=>ie(D.tables.links,t),deleteByPropertyId:async t=>{try{const r=await Q(D.tables.links,{property_id:t});return await Promise.all(r.map(s=>ie(D.tables.links,Number(s.id)))),{success:!0}}catch(r){return console.error("Error deleting links by property ID:",r),{success:!1}}}},te=t=>!t||typeof t.latitude!="number"||typeof t.longitude!="number"||isNaN(t.latitude)||isNaN(t.longitude)?q:t,He=t=>{if(!t||typeof t!="object")return!1;const{north:r,south:s,east:a,west:n}=t;return typeof r=="number"&&!isNaN(r)&&typeof s=="number"&&!isNaN(s)&&typeof a=="number"&&!isNaN(a)&&typeof n=="number"&&!isNaN(n)&&r>s&&a>n},as=t=>{if(!t)return console.log("No bounds provided"),null;try{if(typeof t.getNorth=="function"){const r={north:t.getNorth(),south:t.getSouth(),east:t.getEast(),west:t.getWest()};return console.log("Converted LngLatBounds to plain object:",r),He(r)?r:null}return He(t)?(console.log("Using valid plain object bounds:",t),t):(console.log("Invalid bounds detected, not setting bounds in viewport"),null)}catch(r){return console.error("Error converting bounds:",r),null}},We=t=>{const r={latitude:q.latitude,longitude:q.longitude,zoom:K.defaultZoom};t.latitude&&typeof t.latitude=="number"&&!isNaN(t.latitude)&&(r.latitude=t.latitude),t.longitude&&typeof t.longitude=="number"&&!isNaN(t.longitude)&&(r.longitude=t.longitude),t.zoom&&typeof t.zoom=="number"&&!isNaN(t.zoom)&&(r.zoom=t.zoom);const s=as(t.bounds);return s&&(r.bounds=s),r},ns=(t,r)=>{const s=[...t];switch(r){case"price_asc":return s.sort((a,n)=>a.price_min-n.price_min);case"price_desc":return s.sort((a,n)=>n.price_min-a.price_min);case"size_asc":return s.sort((a,n)=>a.size_min-n.size_min);case"size_desc":return s.sort((a,n)=>n.size_min-a.size_min);case"rating_desc":return s.sort((a,n)=>(n.rating||0)-(a.rating||0));case"newest":return s.sort((a,n)=>n.id-a.id);case"oldest":return s.sort((a,n)=>a.id-n.id);default:return s}},os=(t,r,s,a)=>{var x,u,g,h,L,N,S,R,E,w,$,z,P,f,p,_,k,b,U,Z,O;if(!r||!r.trim())return!0;const n=r.toLowerCase().trim();if([t.area,t.zone,t.description,t.note,t.type,(x=t.price_min)==null?void 0:x.toString(),(u=t.price_max)==null?void 0:u.toString(),(g=t.size_min)==null?void 0:g.toString(),(h=t.size_max)==null?void 0:h.toString(),(L=t.rating)==null?void 0:L.toString(),(N=t.radius)==null?void 0:N.toString(),(S=t.id)==null?void 0:S.toString(),(R=Math.round(t.size_min))==null?void 0:R.toString(),(E=Math.round(t.size_max))==null?void 0:E.toString(),(w=t.price_min)==null?void 0:w.toFixed(1),($=t.price_max)==null?void 0:$.toFixed(1),(P=(z=t.location)==null?void 0:z.latitude)==null?void 0:P.toString(),(p=(f=t.location)==null?void 0:f.longitude)==null?void 0:p.toString(),(k=(_=t.location)==null?void 0:_.latitude)==null?void 0:k.toFixed(6),(U=(b=t.location)==null?void 0:b.longitude)==null?void 0:U.toFixed(6),t.radius&&t.radius>=1e3?`${(t.radius/1e3).toFixed(1)}km`:`${t.radius}m`,...t.tags,t.tags.join(" "),t.created_on,t.updated_on].filter(Boolean).some(o=>o&&o.toString().toLowerCase().includes(n)))return!0;const c=s.filter(o=>o.property_id===t.id);for(const o of c){if([o.remark,o.role,(Z=o.id)==null?void 0:Z.toString()].filter(Boolean).some(F=>F&&F.toString().toLowerCase().includes(n)))return!0;const d=a.find(F=>F.id===o.person_id);if(d&&[d.name,d.phone,d.alternative_contact,d.about,d.role,(O=d.id)==null?void 0:O.toString()].filter(Boolean).some(V=>V&&V.toString().toLowerCase().includes(n)))return!0}return!1},is=(t,r,s,a)=>{var x,u,g,h,L,N,S,R,E,w,$,z,P,f,p,_,k;if(!r||!r.trim())return!0;const n=r.toLowerCase().trim();if([t.name,t.phone,t.alternative_contact,t.about,t.role,(x=t.id)==null?void 0:x.toString()].filter(Boolean).some(b=>b&&b.toString().toLowerCase().includes(n)))return!0;const c=s.filter(b=>b.person_id===t.id);for(const b of c){if([b.remark,b.role,(u=b.id)==null?void 0:u.toString()].filter(Boolean).some(o=>o&&o.toString().toLowerCase().includes(n)))return!0;const O=a.find(o=>o.id===b.property_id);if(O&&[O.area,O.zone,O.description,O.note,O.type,(g=O.price_min)==null?void 0:g.toString(),(h=O.price_max)==null?void 0:h.toString(),(L=O.size_min)==null?void 0:L.toString(),(N=O.size_max)==null?void 0:N.toString(),(S=O.rating)==null?void 0:S.toString(),(R=O.radius)==null?void 0:R.toString(),(E=O.id)==null?void 0:E.toString(),(w=Math.round(O.size_min))==null?void 0:w.toString(),($=Math.round(O.size_max))==null?void 0:$.toString(),(z=O.price_min)==null?void 0:z.toFixed(1),(P=O.price_max)==null?void 0:P.toFixed(1),(p=(f=O.location)==null?void 0:f.latitude)==null?void 0:p.toString(),(k=(_=O.location)==null?void 0:_.longitude)==null?void 0:k.toString(),...O.tags,O.tags.join(" ")].filter(Boolean).some(B=>B&&B.toString().toLowerCase().includes(n)))return!0}return!1},ls=()=>{try{const t=localStorage.getItem("propertyFilters");if(t){const r=JSON.parse(t);return{priceRange:r.priceRange||[0,1e12],sizeRange:r.sizeRange||[0,1e7],propertyTypes:r.propertyTypes||[],searchQuery:r.searchQuery||"",tags:r.tags||[],excludedTags:r.excludedTags||[],rating:r.rating,sortBy:r.sortBy||"newest",hasLocation:r.hasLocation||null,radiusRange:r.radiusRange||[0,5e4]}}}catch(t){console.error("Error loading filters from storage:",t)}return{priceRange:[0,1e12],sizeRange:[0,1e7],propertyTypes:[],searchQuery:"",tags:[],excludedTags:[],sortBy:"newest",hasLocation:null,radiusRange:[0,5e4]}},cs=()=>{try{const t=localStorage.getItem("personFilters");if(t){const r=JSON.parse(t);return{searchQuery:r.searchQuery||"",roles:r.roles||[],hasProperties:r.hasProperties}}}catch(t){console.error("Error loading person filters from storage:",t)}return{searchQuery:"",roles:[],hasProperties:null}},ds=()=>{try{const t=localStorage.getItem("mapViewport");if(t){const r=JSON.parse(t);return We(r)}}catch(t){console.error("Error loading map viewport from storage:",t)}return We({latitude:q.latitude,longitude:q.longitude,zoom:K.defaultZoom})},us=ls(),ms=cs(),xs=ds(),ps={properties:!1,persons:!1,connections:!1,links:!1,creating:!1,updating:!1,deleting:!1,propertyDetails:!1},hs={properties:!1,persons:!1,connections:!1,links:!1},G=kt((t,r)=>({properties:[],filteredProperties:[],persons:[],filteredPersons:[],connections:[],links:[],selectedProperty:null,selectedPerson:null,mapViewport:xs,filters:us,personFilters:ms,isSidebarOpen:!0,isFilterDrawerOpen:!1,isPropertyDetailOpen:!1,isMobileView:!1,showPropertyForm:!1,showPersonForm:!1,editingProperty:null,editingPerson:null,activeTab:"properties",isLiveView:!1,isLoading:!1,error:null,dataLoaded:hs,loadingStates:ps,propertyConnections:{},propertyLinks:{},propertyPersons:{},setProperties:s=>{console.log("Setting properties:",s.length);const a=s.map(n=>({...n,location:te(n.location)}));t({properties:a,dataLoaded:{...r().dataLoaded,properties:!0}}),r().filterProperties()},setPersons:s=>{console.log("Setting persons:",s.length),t({persons:s,dataLoaded:{...r().dataLoaded,persons:!0}}),r().filterPersons()},setConnections:s=>{console.log("Setting connections:",s.length),t({connections:s,dataLoaded:{...r().dataLoaded,connections:!0}});const{propertyConnections:a}=r(),n={...a};s.forEach(i=>{const l=i.property_id;n[l]||(n[l]=[]),n[l].find(c=>c.id===i.id)||n[l].push(i)}),t({propertyConnections:n})},setLinks:s=>{console.log("Setting links:",s.length),t({links:s,dataLoaded:{...r().dataLoaded,links:!0}});const{propertyLinks:a}=r(),n={...a};s.forEach(i=>{const l=i.property_id;n[l]||(n[l]=[]),n[l].find(c=>c.id===i.id)||n[l].push(i)}),t({propertyLinks:n})},setSelectedProperty:s=>{if(s){const a={...s,location:te(s.location)};t({selectedProperty:a}),r().focusMapOnProperty(a),r().loadPropertyDetails(a.id)}else t({selectedProperty:null})},setSelectedPerson:s=>t({selectedPerson:s}),setMapViewport:s=>{const a=r().mapViewport,n=We({...a,...s});console.log("Setting map viewport:",n),t({mapViewport:n});try{localStorage.setItem("mapViewport",JSON.stringify(n))}catch(i){console.error("Error saving map viewport to storage:",i)}r().isLiveView&&r().filterProperties()},updateFilters:s=>{console.log("Updating filters:",s);const a={...r().filters,...s};t({filters:a});try{localStorage.setItem("propertyFilters",JSON.stringify(a))}catch(n){console.error("Error saving filters to storage:",n)}r().filterProperties()},updatePersonFilters:s=>{const a={...r().personFilters,...s};t({personFilters:a});try{localStorage.setItem("personFilters",JSON.stringify(a))}catch(n){console.error("Error saving person filters to storage:",n)}r().filterPersons()},resetFilters:()=>{console.log("Resetting filters");const s={priceRange:[0,1e12],sizeRange:[0,1e7],propertyTypes:[],searchQuery:"",tags:[],excludedTags:[],sortBy:"newest",hasLocation:null,radiusRange:[0,5e4]};t({filters:s});try{localStorage.setItem("propertyFilters",JSON.stringify(s))}catch(a){console.error("Error saving reset filters to storage:",a)}r().filterProperties()},resetPersonFilters:()=>{const s={searchQuery:"",roles:[],hasProperties:null};t({personFilters:s});try{localStorage.setItem("personFilters",JSON.stringify(s))}catch(a){console.error("Error saving reset person filters to storage:",a)}r().filterPersons()},toggleSidebar:()=>t({isSidebarOpen:!r().isSidebarOpen}),toggleFilterDrawer:()=>t({isFilterDrawerOpen:!r().isFilterDrawerOpen}),togglePropertyDetail:s=>t({isPropertyDetailOpen:s!==void 0?s:!r().isPropertyDetailOpen}),setMobileView:s=>t({isMobileView:s}),togglePropertyForm:s=>{const a=s?{...s,location:te(s.location)}:null;t({showPropertyForm:!r().showPropertyForm,editingProperty:a})},togglePersonForm:s=>t({showPersonForm:!r().showPersonForm,editingPerson:s||null}),setActiveTab:s=>{console.log("Setting active tab:",s),t({activeTab:s}),s==="properties"?r().dataLoaded.properties||r().loadProperties():s==="persons"&&r().loadAllData()},setFilteredProperties:s=>{const a=s.map(n=>({...n,location:te(n.location)}));t({filteredProperties:a})},setIsLiveView:s=>{t({isLiveView:s}),r().filterProperties()},setLoading:s=>t({isLoading:s}),setError:s=>t({error:s}),setLoadingState:(s,a)=>{t({loadingStates:{...r().loadingStates,[s]:a}})},loadProperties:async()=>{const{dataLoaded:s}=r();if(s.properties){console.log("Properties already loaded");return}try{console.log("Loading properties..."),r().setLoadingState("properties",!0);const a=await ke.getAll();console.log("Loaded properties:",a.length);const n=a.map(i=>({...i,location:te(i.location)}));if(t({properties:n,error:null,dataLoaded:{...r().dataLoaded,properties:!0}}),r().filterProperties(),n.length>0&&!r().mapViewport.bounds){const i=n.find(l=>l.location.latitude!==q.latitude||l.location.longitude!==q.longitude);i&&r().setMapViewport({latitude:i.location.latitude,longitude:i.location.longitude,zoom:K.focusZoom})}}catch(a){console.error("Failed to load properties:",a),t({error:H.loadProperties+": "+a.message})}finally{r().setLoadingState("properties",!1)}},loadPersons:async()=>{const{dataLoaded:s}=r();if(s.persons){console.log("Persons already loaded");return}try{console.log("Loading persons..."),r().setLoadingState("persons",!0);const a=await Pe.getAll();console.log("Loaded persons:",a.length),t({persons:a,error:null,dataLoaded:{...r().dataLoaded,persons:!0}}),r().filterPersons()}catch(a){console.error("Failed to load persons:",a),t({error:H.loadPersons+": "+a.message})}finally{r().setLoadingState("persons",!1)}},loadConnections:async()=>{const{dataLoaded:s}=r();if(s.connections){console.log("Connections already loaded");return}try{console.log("Loading connections..."),r().setLoadingState("connections",!0);const a=await Oe.getAll();console.log("Loaded connections:",a.length),t({connections:a,error:null,dataLoaded:{...r().dataLoaded,connections:!0}});const n={};a.forEach(i=>{const l=i.property_id;n[l]||(n[l]=[]),n[l].push(i)}),t({propertyConnections:n})}catch(a){console.error("Failed to load connections:",a),t({error:H.loadConnections+": "+a.message})}finally{r().setLoadingState("connections",!1)}},loadLinks:async()=>{const{dataLoaded:s}=r();if(s.links){console.log("Links already loaded");return}try{console.log("Loading links..."),r().setLoadingState("links",!0);const a=await Se.getAll();console.log("Loaded links:",a.length),t({links:a,error:null,dataLoaded:{...r().dataLoaded,links:!0}});const n={};a.forEach(i=>{const l=i.property_id;n[l]||(n[l]=[]),n[l].push(i)}),t({propertyLinks:n})}catch(a){console.error("Failed to load links:",a),t({error:H.loadLinks+": "+a.message})}finally{r().setLoadingState("links",!1)}},loadAllData:async()=>{console.log("Loading all data...");const{dataLoaded:s}=r(),a=[];if(s.properties||a.push(r().loadProperties()),s.persons||a.push(r().loadPersons()),s.connections||a.push(r().loadConnections()),s.links||a.push(r().loadLinks()),a.length>0)try{await Promise.all(a),console.log("All data loaded successfully"),r().updatePropertyPersonsCache()}catch(n){console.error("Failed to load all data:",n)}else console.log("All data already loaded"),r().updatePropertyPersonsCache()},updatePropertyPersonsCache:()=>{const{connections:s,persons:a}=r(),n={};s.forEach(i=>{const l=i.property_id,c=a.find(x=>x.id===i.person_id);c&&(n[l]||(n[l]=[]),n[l].find(x=>x.id===c.id)||n[l].push(c))}),t({propertyPersons:n})},loadPropertyDetails:async s=>{console.log(`Loading details for property ${s}...`),await r().loadAllData(),console.log(`Property ${s} details loaded from cache`)},createProperty:async s=>{try{r().setLoadingState("creating",!0),console.log("Creating property:",s);const a={...s,location:te(s.location),rating:s.rating||0},n=await ke.create(a);console.log("Property created:",n),n.success&&(t({dataLoaded:{...r().dataLoaded,properties:!1}}),await r().loadProperties())}catch(a){throw console.error("Failed to create property:",a),t({error:H.createProperty+": "+a.message}),a}finally{r().setLoadingState("creating",!1)}},updateProperty:async s=>{var a;try{r().setLoadingState("updating",!0),console.log("Updating property:",s);const n={...s,location:te(s.location),rating:s.rating||0},i=await ke.update(n);if(console.log("Property updated:",i),i.success){const l=r().properties.map(c=>c.id===s.id?n:c);t({properties:l}),r().filterProperties(),((a=r().selectedProperty)==null?void 0:a.id)===s.id&&t({selectedProperty:n})}}catch(n){throw console.error("Failed to update property:",n),t({error:H.updateProperty+": "+n.message}),n}finally{r().setLoadingState("updating",!1)}},deleteProperty:async s=>{var a;try{r().setLoadingState("deleting",!0),console.log("Deleting property:",s);const n=await ke.delete(s);if(console.log("Property deleted:",n),n.success){const i=r().properties.filter(L=>L.id!==s);t({properties:i}),r().filterProperties();const{propertyConnections:l,propertyLinks:c,propertyPersons:x}=r(),u={...l},g={...c},h={...x};delete u[s],delete g[s],delete h[s],t({propertyConnections:u,propertyLinks:g,propertyPersons:h}),((a=r().selectedProperty)==null?void 0:a.id)===s&&t({selectedProperty:null,isPropertyDetailOpen:!1})}}catch(n){throw console.error("Failed to delete property:",n),t({error:H.deleteProperty+": "+n.message}),n}finally{r().setLoadingState("deleting",!1)}},createPerson:async s=>{try{r().setLoadingState("creating",!0),console.log("Creating person:",s);const a=await Pe.create(s);if(console.log("Person created:",a),a.success){const n={...s,id:a.id};t({persons:[...r().persons,n]}),r().filterPersons()}}catch(a){throw console.error("Failed to create person:",a),t({error:H.createPerson+": "+a.message}),a}finally{r().setLoadingState("creating",!1)}},updatePerson:async s=>{try{r().setLoadingState("updating",!0),console.log("Updating person:",s);const a=await Pe.update(s);if(console.log("Person updated:",a),a.success){const n=r().persons.map(i=>i.id===s.id?s:i);t({persons:n}),r().filterPersons(),r().updatePropertyPersonsCache()}}catch(a){throw console.error("Failed to update person:",a),t({error:H.updatePerson+": "+a.message}),a}finally{r().setLoadingState("updating",!1)}},deletePerson:async s=>{try{r().setLoadingState("deleting",!0),console.log("Deleting person:",s);const a=await Pe.delete(s);if(console.log("Person deleted:",a),a.success){const n=r().persons.filter(i=>i.id!==s);t({persons:n}),r().filterPersons(),r().updatePropertyPersonsCache()}}catch(a){throw console.error("Failed to delete person:",a),t({error:H.deletePerson+": "+a.message}),a}finally{r().setLoadingState("deleting",!1)}},createConnection:async s=>{try{r().setLoadingState("creating",!0),console.log("Creating connection:",s);const a=await Oe.create(s);if(console.log("Connection created:",a),a.success){const n={...s,id:a.id};t({connections:[...r().connections,n]});const{propertyConnections:i}=r(),l=s.property_id,c=i[l]||[];t({propertyConnections:{...i,[l]:[...c,n]}}),r().updatePropertyPersonsCache()}}catch(a){throw console.error("Failed to create connection:",a),t({error:H.createConnection+": "+a.message}),a}finally{r().setLoadingState("creating",!1)}},deleteConnection:async s=>{var a;try{r().setLoadingState("deleting",!0),console.log("Deleting connection:",s);const n=r().connections.find(l=>l.id===s),i=await Oe.delete(s);if(console.log("Connection deleted:",i),i.success){const l=r().connections.filter(c=>c.id!==s);if(t({connections:l}),n){const{propertyConnections:c}=r(),x=n.property_id,u=((a=c[x])==null?void 0:a.filter(g=>g.id!==s))||[];t({propertyConnections:{...c,[x]:u}})}r().updatePropertyPersonsCache()}}catch(n){throw console.error("Failed to delete connection:",n),t({error:H.deleteConnection+": "+n.message}),n}finally{r().setLoadingState("deleting",!1)}},createLink:async s=>{try{r().setLoadingState("creating",!0),console.log("Creating link:",s);const a=await Se.create(s);if(console.log("Link created:",a),a.success){const n={...s,id:a.id};t({links:[...r().links,n]});const{propertyLinks:i}=r(),l=s.property_id,c=i[l]||[];t({propertyLinks:{...i,[l]:[...c,n]}})}}catch(a){throw console.error("Failed to create link:",a),t({error:H.createLink+": "+a.message}),a}finally{r().setLoadingState("creating",!1)}},updateLink:async s=>{try{r().setLoadingState("updating",!0),console.log("Updating link:",s);const a=await Se.update(s);if(console.log("Link updated:",a),a.success){const n=r().links.map(u=>u.id===s.id?s:u);t({links:n});const{propertyLinks:i}=r(),l=s.property_id,x=(i[l]||[]).map(u=>u.id===s.id?s:u);t({propertyLinks:{...i,[l]:x}})}}catch(a){throw console.error("Failed to update link:",a),t({error:H.updateLink+": "+a.message}),a}finally{r().setLoadingState("updating",!1)}},deleteLink:async s=>{var a;try{r().setLoadingState("deleting",!0),console.log("Deleting link:",s);const n=r().links.find(l=>l.id===s),i=await Se.delete(s);if(console.log("Link deleted:",i),i.success){const l=r().links.filter(c=>c.id!==s);if(t({links:l}),n){const{propertyLinks:c}=r(),x=n.property_id,u=((a=c[x])==null?void 0:a.filter(g=>g.id!==s))||[];t({propertyLinks:{...c,[x]:u}})}}}catch(n){throw console.error("Failed to delete link:",n),t({error:H.deleteLink+": "+n.message}),n}finally{r().setLoadingState("deleting",!1)}},filterProperties:()=>{const{properties:s,filters:a,isLiveView:n,mapViewport:i,connections:l,persons:c}=r();console.log("Filtering properties:",{totalProperties:s.length,filters:a,isLiveView:n,hasMapBounds:!!i.bounds});let x=s.map(g=>({...g,location:te(g.location)}));if(x=x.filter(g=>{if(a.searchQuery&&a.searchQuery.trim()&&!os(g,a.searchQuery,l,c)||(a.priceRange[0]>0||a.priceRange[1]<1e10)&&(g.price_min>a.priceRange[1]||g.price_max<a.priceRange[0])||(a.sizeRange[0]>0||a.sizeRange[1]<1e4)&&(g.size_min>a.sizeRange[1]||g.size_max<a.sizeRange[0])||a.propertyTypes.length>0&&(!g.type||!a.propertyTypes.includes(g.type))||a.rating!==void 0&&(!g.rating||g.rating<a.rating)||a.tags.length>0&&!a.tags.some(h=>g.tags.includes(h))||a.excludedTags.length>0&&a.excludedTags.some(h=>g.tags.includes(h)))return!1;if(a.hasLocation!==null){const h=g.location.latitude!==q.latitude||g.location.longitude!==q.longitude;if(a.hasLocation!==h)return!1}if(a.radiusRange[0]>0||a.radiusRange[1]<5e4){const h=g.radius||0;if(h<a.radiusRange[0]||h>a.radiusRange[1])return!1}return!0}),console.log("After search and filters:",x.length,"out of",s.length),n&&i.bounds&&He(i.bounds)){const{north:g,south:h,east:L,west:N}=i.bounds;x=x.filter(S=>{const{latitude:R,longitude:E}=S.location;return R<=g&&R>=h&&E<=L&&E>=N}),console.log("After viewport filter:",x.length)}const u=ns(x,a.sortBy);console.log("Final filtered and sorted properties:",u.length,"out of",s.length),t({filteredProperties:u})},filterPersons:()=>{const{persons:s,personFilters:a,connections:n,properties:i}=r();console.log("Filtering persons:",{totalPersons:s.length,personFilters:a});const l=s.filter(c=>{if(a.searchQuery&&a.searchQuery.trim()&&!is(c,a.searchQuery,n,i)||a.roles.length>0&&!a.roles.includes(c.role||""))return!1;if(a.hasProperties!==null){const x=n.some(u=>u.person_id===c.id);if(a.hasProperties!==x)return!1}return!0});console.log("Final filtered persons:",l.length,"out of",s.length),t({filteredPersons:l})},getPropertyPersons:s=>{const{propertyPersons:a}=r();return a[s]||[]},getPropertyLinks:s=>{const{propertyLinks:a}=r();return a[s]||[]},focusMapOnProperty:s=>{const a=te(s.location);r().setMapViewport({latitude:a.latitude,longitude:a.longitude,zoom:K.detailZoom})},getAllTags:()=>{const{properties:s}=r(),a=new Set;return s.forEach(n=>{n.tags.forEach(i=>{i.trim()&&a.add(i.trim())})}),Array.from(a).sort()}})),gs=()=>{const{isSidebarOpen:t,toggleSidebar:r,isMobileView:s,togglePropertyForm:a,togglePersonForm:n,activeTab:i,setActiveTab:l}=G();return e.jsx("header",{className:"bg-white shadow-md fixed top-0 left-0 right-0 z-10 h-14",children:e.jsxs("div",{className:"h-full flex items-center justify-between px-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[s&&e.jsx("button",{onClick:r,className:"p-2 rounded-md hover:bg-gray-100 transition-colors","aria-label":t?"Close sidebar":"Open sidebar",children:t?e.jsx(J,{size:20}):e.jsx(It,{size:20})}),e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[e.jsxs("button",{onClick:()=>l("properties"),className:`flex items-center px-3 py-1.5 rounded-md transition-colors ${i==="properties"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(Ue,{size:18}),e.jsx("span",{className:"ml-2",children:"Properties"})]}),e.jsxs("button",{onClick:()=>l("persons"),className:`flex items-center px-3 py-1.5 rounded-md transition-colors ${i==="persons"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(Zt,{size:18}),e.jsx("span",{className:"ml-2",children:"Persons"})]})]})]}),e.jsxs("button",{onClick:()=>i==="properties"?a():n(),className:"flex items-center space-x-1 px-3 py-1.5 bg-blue-500 hover:bg-blue-600 text-white rounded-md transition-colors",children:[e.jsx(le,{size:18}),e.jsxs("span",{className:"hidden sm:inline",children:["Add ",i==="properties"?"Property":"Person"]})]})]})})},X=t=>t>=100?`${(t/100).toFixed(1)} Cr`:t>=1?`${t.toFixed(1)} Lakh`:`${(t*100).toFixed(0)}K`,Qe=({isOpen:t,title:r,message:s,confirmText:a="Confirm",cancelText:n="Cancel",onConfirm:i,onCancel:l,type:c="danger"})=>{if(!t)return null;const u=(()=>{switch(c){case"danger":return{icon:"text-red-500",button:"bg-red-500 hover:bg-red-600 text-white",border:"border-red-200"};case"warning":return{icon:"text-yellow-500",button:"bg-yellow-500 hover:bg-yellow-600 text-white",border:"border-yellow-200"};default:return{icon:"text-blue-500",button:"bg-blue-500 hover:bg-blue-600 text-white",border:"border-blue-200"}}})();return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[70] flex items-center justify-center",children:e.jsx("div",{className:"bg-white rounded-lg w-full max-w-md mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:`p-2 rounded-full bg-gray-100 ${u.border}`,children:e.jsx(Mt,{size:24,className:u.icon})}),e.jsx("div",{children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r})})]}),e.jsx("p",{className:"text-gray-600 mb-6",children:s}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:l,className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:n}),e.jsx("button",{onClick:i,className:`px-4 py-2 rounded-md transition-colors ${u.button}`,children:a})]})]})})})};var W=63710088e-1,bs={centimeters:W*100,centimetres:W*100,degrees:W/111325,feet:W*3.28084,inches:W*39.37,kilometers:W/1e3,kilometres:W/1e3,meters:W,metres:W,miles:W/1609.344,millimeters:W*1e3,millimetres:W*1e3,nauticalmiles:W/1852,radians:1,yards:W*1.0936};function ft(t,r,s){s===void 0&&(s={});var a={type:"Feature"};return(s.id===0||s.id)&&(a.id=s.id),s.bbox&&(a.bbox=s.bbox),a.properties=r||{},a.geometry=t,a}function Je(t,r,s){if(s===void 0&&(s={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!st(t[0])||!st(t[1]))throw new Error("coordinates must contain numbers");var a={type:"Point",coordinates:t};return ft(a,r,s)}function fs(t,r,s){s===void 0&&(s={});for(var a=0,n=t;a<n.length;a++){var i=n[a];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var l=0;l<i[i.length-1].length;l++)if(i[i.length-1][l]!==i[0][l])throw new Error("First and last Position are not equivalent.")}var c={type:"Polygon",coordinates:t};return ft(c,r,s)}function ys(t,r){r===void 0&&(r="kilometers");var s=bs[r];if(!s)throw new Error(r+" units is invalid");return t/s}function tt(t){var r=t%(2*Math.PI);return r*180/Math.PI}function De(t){var r=t%360;return r*Math.PI/180}function st(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function js(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return t.geometry.coordinates;if(t.type==="Point")return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function vs(t,r,s,a){a===void 0&&(a={});var n=js(t),i=De(n[0]),l=De(n[1]),c=De(s),x=ys(r,a.units),u=Math.asin(Math.sin(l)*Math.cos(x)+Math.cos(l)*Math.sin(x)*Math.cos(c)),g=i+Math.atan2(Math.sin(c)*Math.sin(x)*Math.cos(l),Math.cos(x)-Math.sin(l)*Math.sin(u)),h=tt(g),L=tt(u);return Je([h,L],a.properties)}function yt(t,r,s){s===void 0&&(s={});for(var a=s.steps||64,n=s.properties?s.properties:!Array.isArray(t)&&t.type==="Feature"&&t.properties?t.properties:{},i=[],l=0;l<a;l++)i.push(vs(t,r,l*-360/a,s).geometry.coordinates);return i.push(i[0]),fs([i],n)}const jt=({property:t,onClose:r})=>{const{updateProperty:s}=G(),a={latitude:29.3864726,longitude:76.9956668},n=[0,20,50,100,200,300,500,700,1e3,2e3,3e3,4e3,5e3,7e3,1e4,15e3,2e4,25e3,3e4,5e4],i=j=>!j||typeof j.latitude!="number"||typeof j.longitude!="number"||isNaN(j.latitude)||isNaN(j.longitude)?a:j,[l,c]=y.useState(()=>i(t.location)),[x,u]=y.useState(t.radius||0),[g,h]=y.useState(()=>{const j=localStorage.getItem("mapSatelliteView");return j?JSON.parse(j):!0}),[L,N]=y.useState(()=>{const j=i(t.location);return{latitude:j.latitude,longitude:j.longitude,zoom:15}}),[S,R]=y.useState(null),[E,w]=y.useState(!1),[$,z]=y.useState(""),[P,f]=y.useState(!1),[p,_]=y.useState([]),[k,b]=y.useState(!1),[U,Z]=y.useState(!1);y.useEffect(()=>{localStorage.setItem("mapSatelliteView",JSON.stringify(g))},[g]);const O=y.useCallback(j=>{if(!j.trim())return[];const T=[],m=j.toLowerCase();return Ge.forEach(A=>{A.toLowerCase().includes(m)&&(T.push(`${A}, Panipat`),T.push(A))}),m.length>2&&(T.push(`${j}, Panipat`),T.push(`${j}, Haryana`),T.push(`${j}, India`)),Array.from(new Set(T)).slice(0,8)},[]),o=j=>{if(z(j),j.trim()){const T=O(j);_(T),b(T.length>0)}else _([]),b(!1)},C=()=>{if($.trim()){const j=O($);_(j),b(j.length>0)}else{const j=Ge.slice(0,8).map(T=>`${T}, Panipat`);_(j),b(!0)}},B=()=>{setTimeout(()=>{b(!1)},150)},d=async j=>{var T;try{f(!0);let m=j.trim();const A=m.toLowerCase();A.includes("india")||(A.includes("haryana")?m=`${m}, India`:A.includes("panipat")?m=`${m}, Haryana, India`:m=`${m}, Panipat, Haryana, India`),console.log("Geocoding query:",m);const me=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(m)}&limit=5&countrycodes=in&addressdetails=1`);if(!me.ok)throw new Error("Geocoding service unavailable");const xe=await me.json();if(console.log("Geocoding response:",xe),xe&&xe.length>0){let pe=xe[0];for(const ve of xe){const ge=((T=ve.display_name)==null?void 0:T.toLowerCase())||"";if(ge.includes("panipat")||ge.includes("haryana")){pe=ve;break}}const he=parseFloat(pe.lat),re=parseFloat(pe.lon);if(!isNaN(he)&&!isNaN(re))return c({latitude:he,longitude:re}),N({latitude:he,longitude:re,zoom:16}),b(!1),!0}if(xe.length===0&&!A.includes("india")){const pe=`${j.trim()}, India`;console.log("Trying broader search:",pe);const he=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(pe)}&limit=5&countrycodes=in&addressdetails=1`);if(he.ok){const re=await he.json();if(console.log("Broad search response:",re),re&&re.length>0){const ve=re[0],ge=parseFloat(ve.lat),Ie=parseFloat(ve.lon);if(!isNaN(ge)&&!isNaN(Ie))return c({latitude:ge,longitude:Ie}),N({latitude:ge,longitude:Ie,zoom:16}),b(!1),!0}}}throw new Error("Location not found")}catch(m){return console.error("Geocoding error:",m),U?console.log(`Auto-search failed for "${j}" - this is normal, continuing with default location`):alert(`Unable to find location "${j}". Please try a more specific address or check the spelling.`),!1}finally{f(!1)}},F=async j=>{j.preventDefault(),$.trim()&&await d($.trim())},I=async j=>{z(j),b(!1),await d(j)};y.useEffect(()=>{const T=setTimeout(async()=>{if(t.zone&&t.zone!=="Other"&&t.zone.trim()&&!U){const m=`${t.zone}, Panipat`;z(m),Z(!0),console.log("Auto-searching for zone:",m),await d(m)}},500);return()=>clearTimeout(T)},[t.zone,U]);const V=y.useCallback(j=>{if(!j||!j.lngLat){console.warn("Invalid map click event - missing event or lngLat:",j);return}const{lat:T,lng:m}=j.lngLat;if(typeof T!="number"||typeof m!="number"||isNaN(T)||isNaN(m)){console.warn("Invalid map click coordinates:",{lat:T,lng:m});return}c({latitude:T,longitude:m})},[]),Y=()=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(j=>{const{latitude:T,longitude:m}=j.coords;if(isNaN(T)||isNaN(m)){console.warn("Invalid GPS coordinates:",{latitude:T,longitude:m});return}R({latitude:T,longitude:m}),c({latitude:T,longitude:m}),N({latitude:T,longitude:m,zoom:16})},j=>{console.error("Error getting location:",j),alert("Unable to get your location. Please check your GPS settings and try again.")},{enableHighAccuracy:!0,timeout:3e4,maximumAge:0}):alert("GPS is not supported in your browser")};y.useEffect(()=>{let j;return"geolocation"in navigator&&(j=navigator.geolocation.watchPosition(T=>{const{latitude:m,longitude:A}=T.coords;!isNaN(m)&&!isNaN(A)&&R({latitude:m,longitude:A})},T=>{console.error("Error watching position:",T)},{enableHighAccuracy:!0,timeout:3e4,maximumAge:6e4})),()=>{j&&navigator.geolocation.clearWatch(j)}},[]);const de=j=>j>=1e3?`${(j/1e3).toFixed(1)}km`:`${j}m`,we=()=>{if(!l||!x)return null;const j=Je([l.longitude,l.latitude]);return yt(j,x,{steps:64,units:"meters"})},ue=async()=>{w(!0);try{const j={...t,location:l,radius:x};await s(j),r()}catch(j){console.error("Failed to update location:",j),alert("Failed to update location. Please try again.")}finally{w(!1)}},Ee={version:8,sources:{osm:{type:"raster",tiles:[g?K.satelliteUrl:K.streetUrl],tileSize:256,attribution:g?" Esri":" OpenStreetMap contributors"}},layers:[{id:"osm",type:"raster",source:"osm",minzoom:0,maxzoom:19}]};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[200] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between flex-shrink-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Update Location"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.area})]}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(J,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("form",{onSubmit:F,className:"relative",children:[e.jsx("input",{type:"text",value:$,onChange:j=>o(j.target.value),onFocus:C,onBlur:B,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Search for a location...",disabled:P}),e.jsx("button",{type:"submit",disabled:P||!$.trim(),className:"absolute right-2 top-1/2 transform -translate-y-1/2 p-2 text-gray-400 hover:text-gray-600 disabled:opacity-50",children:P?e.jsx(ce,{size:20,className:"animate-spin"}):e.jsx(se,{size:20})})]}),k&&p.length>0&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:p.map((j,T)=>e.jsx("button",{type:"button",onClick:()=>I(j),className:"w-full text-left px-4 py-3 hover:bg-gray-100 transition-colors border-b border-gray-100 last:border-b-0",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ee,{size:16,className:"text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"text-gray-900",children:j})]})},T))})]}),e.jsx("div",{className:"h-60 md:h-[22.5rem] rounded-lg overflow-hidden border relative",children:e.jsxs(rt,{...L,style:{width:"100%",height:"100%"},mapStyle:Ee,onClick:V,onMove:j=>N(j.viewState),mapLib:at,minZoom:K.minZoom,maxZoom:K.maxZoom,children:[e.jsx("div",{className:"absolute top-2 right-2 bg-white rounded-md shadow-md z-10 flex flex-col gap-1 p-1",children:e.jsx("button",{type:"button",onClick:()=>h(!g),className:"p-2 hover:bg-gray-100 rounded-md transition-colors w-full flex items-center justify-center",title:g?"Switch to Street View":"Switch to Satellite View",children:g?e.jsx(xt,{size:20}):e.jsx(mt,{size:20})})}),e.jsx(nt,{position:"bottom-right"}),e.jsx("div",{className:"absolute bottom-4 left-4 bg-white rounded-md shadow-md p-1",children:e.jsx("button",{type:"button",className:"p-2 hover:bg-gray-100 rounded-md transition-colors",onClick:Y,title:"Use current location",children:e.jsx(dt,{size:20})})}),l&&x>0&&e.jsxs(ot,{type:"geojson",data:we(),children:[e.jsx(ze,{id:"radius-circle",type:"fill",paint:{"fill-color":"#4285f4","fill-opacity":.15}}),e.jsx(ze,{id:"radius-circle-border",type:"line",paint:{"line-color":"#4285f4","line-width":2}})]}),e.jsx(Me,{longitude:l.longitude,latitude:l.latitude,anchor:"center",draggable:!0,onDragEnd:j=>{if(!j||!j.lngLat){console.warn("Invalid drag end event - missing event or lngLat:",j);return}const{lat:T,lng:m}=j.lngLat;if(typeof T!="number"||typeof m!="number"||isNaN(T)||isNaN(m)){console.warn("Invalid drag end coordinates:",{lat:T,lng:m});return}c({latitude:T,longitude:m})},children:e.jsx("div",{className:"cursor-grab active:cursor-grabbing",children:e.jsx("div",{className:"relative flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 bg-red-500 rounded-full border-2 border-white shadow-lg flex items-center justify-center",children:e.jsx(ee,{size:20,className:"text-white"})})})})}),S&&e.jsx(Me,{longitude:S.longitude,latitude:S.latitude,anchor:"center",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-full border-2 border-white shadow-lg animate-pulse"}),e.jsx("div",{className:"absolute -inset-1 bg-blue-500 rounded-full opacity-20 animate-ping"})]})})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Coverage Radius"}),e.jsx("input",{type:"range",value:n.indexOf(x),onChange:j=>u(n[Number(j.target.value)]),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",min:"0",max:n.length-1,step:"1"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsx("span",{children:"0m"}),e.jsx("span",{className:"font-medium text-blue-600",children:de(x)}),e.jsx("span",{children:"50km"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Current Coordinates:"}),e.jsxs("div",{className:"font-mono text-sm",children:[l.latitude.toFixed(6),"N, ",l.longitude.toFixed(6),"E"]})]})]})})}),e.jsxs("div",{className:"p-4 border-t bg-gray-50 flex justify-end space-x-3 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",disabled:E,children:"Cancel"}),e.jsx("button",{onClick:ue,disabled:E,className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:E?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Updating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Dt,{size:16}),e.jsx("span",{children:"Update Location"})]})})]})]})})},Ve=10,Ns=()=>{const{filteredProperties:t,selectedProperty:r,setSelectedProperty:s,setMapViewport:a,togglePropertyDetail:n,togglePropertyForm:i,properties:l,setProperties:c,connections:x,setConnections:u,loadingStates:g}=G(),[h,L]=y.useState(1),[N,S]=y.useState(null),[R,E]=y.useState(null),w=Math.ceil(t.length/Ve),$=(h-1)*Ve,z=$+Ve,P=t.slice($,z),f=b=>{s(b),a({latitude:b.location.latitude,longitude:b.location.longitude,zoom:15})},p=()=>{if(!N)return;const b=l.filter(Z=>Z.id!==N.id);c(b);const U=x.filter(Z=>Z.property_id!==N.id);u(U),(r==null?void 0:r.id)===N.id&&s(null),S(null)},_=b=>b.location.latitude!==q.latitude||b.location.longitude!==q.longitude,k=b=>!b||b===0?0:e.jsx("div",{className:"flex items-center space-x-1",children:e.jsxs("div",{className:"flex items-center bg-green-100 text-green-800 px-2 py-0.5 rounded-full text-xs font-medium",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-1"}),e.jsxs("span",{children:[b,"/5"]})]})});return g.properties?e.jsx("div",{className:"flex flex-col h-full",children:e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ce,{className:"w-8 h-8 animate-spin text-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading properties..."})]})})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"flex-1 divide-y overflow-y-auto",children:t.length===0?e.jsx("div",{className:"p-6 text-center",children:e.jsx("p",{className:"text-gray-500",children:"No properties found matching your criteria."})}):P.map(b=>e.jsx("div",{className:`p-4 cursor-pointer transition-colors hover:bg-blue-50 ${(r==null?void 0:r.id)===b.id?"bg-blue-50 border-l-4 border-blue-500":""}`,onClick:()=>f(b),children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 mb-1",children:[e.jsx(Fe,{size:14}),e.jsx("span",{className:"truncate max-w-[120px]",children:b.type||"Property"}),b.zone&&e.jsxs("span",{className:"truncate max-w-[120px]",children:["(",b.zone,")"]})]}),e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:b.area||"Property Area"}),e.jsx("p",{className:"font-light text-gray-900 text-sm my-1 max-w-64",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:b.description||"Property Area"}),!_(b)&&e.jsx("div",{className:"mt-2",children:e.jsxs("button",{onClick:U=>{U.stopPropagation(),E(b)},className:"flex items-center space-x-1 px-2 py-1 bg-orange-100 hover:bg-orange-200 text-orange-700 rounded-md text-xs transition-colors",children:[e.jsx(le,{size:12}),e.jsx("span",{children:"Add Location"})]})})]}),e.jsxs("div",{className:"text-right ml-2",children:[e.jsxs("div",{className:"text-sm font-semibold text-blue-600 flex items-center justify-end",children:[e.jsx(ut,{size:14}),e.jsx("span",{children:X(b.price_min)})]}),b.price_min!==b.price_max&&e.jsxs("div",{className:"text-xs text-gray-500",children:["to ",X(b.price_max)]}),e.jsxs("div",{className:"text-right ml-2",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-600 flex items-center justify-end",children:e.jsxs("span",{children:[b.size_min," Sqyd"]})}),b.size_min!==b.size_max&&e.jsxs("div",{className:"text-xs text-gray-500",children:["to ",b.size_max," Sqyard"]})]})]})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[Number(b.rating)>0&&e.jsx("div",{className:"mt-1",children:k(b.rating)}),b.tags.slice(0,3).map((U,Z)=>e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:[e.jsx(Ne,{size:12,className:"mr-1"}),U]},Z)),b.tags.length>3&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:["+",b.tags.length-3," more"]}),e.jsxs("div",{className:"ml-auto flex items-center space-x-2",children:[e.jsxs("button",{className:"text-xs text-blue-600 hover:text-blue-800 flex items-center space-x-0.5",onClick:U=>{U.stopPropagation(),s(b),n(!0)},children:[e.jsx(Te,{size:12}),e.jsx("span",{children:"Details"})]}),e.jsx("button",{className:"text-xs text-gray-600 hover:text-gray-800 flex items-center space-x-0.5",onClick:U=>{U.stopPropagation(),i(b)},children:e.jsx(fe,{size:12})})]})]})]})},b.id))}),w>1&&e.jsx("div",{className:"p-4 border-t bg-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:()=>L(b=>Math.max(1,b-1)),disabled:h===1,className:"px-3 py-1 rounded-md border disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(lt,{size:16})}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",h," of ",w]}),e.jsx("button",{onClick:()=>L(b=>Math.min(w,b+1)),disabled:h===w,className:"px-3 py-1 rounded-md border disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(ct,{size:16})})]})})]}),e.jsx(Qe,{isOpen:!!N,title:"Delete Property",message:`Are you sure you want to delete "${N==null?void 0:N.name}"? This will permanently remove the property and all its connections. This action cannot be undone.`,confirmText:"Delete Property",onConfirm:p,onCancel:()=>S(null),type:"danger"}),R&&e.jsx(jt,{property:R,onClose:()=>E(null)})]})},Be=10,ws=()=>{const{filteredPersons:t,properties:r,connections:s,setSelectedProperty:a,togglePropertyDetail:n,togglePersonForm:i,deletePerson:l,loadingStates:c}=G(),[x,u]=y.useState(1),[g,h]=y.useState(null),L=Math.ceil(t.length/Be),N=(x-1)*Be,S=N+Be,R=t.slice(N,S),E=p=>s.filter(k=>k.person_id===p).map(k=>{const b=r.find(U=>U.id===k.property_id);return b?{property:b,connection:k}:null}).filter(Boolean),w=p=>{navigator.clipboard.writeText(p)},$=p=>{const k=`https://wa.me/91${p.replace(/\D/g,"")}`;window.open(k,"_blank")},z=p=>{window.location.href=`tel:${p}`},P=(p,_)=>{h({id:p,name:_})},f=async()=>{if(g){try{await l(g.id)}catch(p){console.error("Failed to delete person:",p)}h(null)}};return c.persons?e.jsx("div",{className:"flex flex-col h-full",children:e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ce,{className:"w-8 h-8 animate-spin text-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading persons..."})]})})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"flex-1 overflow-y-auto divide-y",children:t.length===0?e.jsx("div",{className:"p-6 text-center",children:e.jsx("p",{className:"text-gray-500",children:"No persons found matching your criteria."})}):R.map(p=>{const _=E(p.id);return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_e,{size:16,className:"text-gray-500"}),e.jsx("h3",{className:"font-medium",children:p.name})]}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:p.role}),p.about&&e.jsxs("div",{className:"bg-gray-50 p-2 rounded border mt-2",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"About"}),e.jsx("div",{className:"text-sm text-gray-700",children:p.about})]}),p.phone&&e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded border mt-2",children:[e.jsx("span",{className:"text-sm font-mono",children:p.phone}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>w(p.phone),className:"p-1 text-gray-500 hover:text-gray-700",title:"Copy number",children:e.jsx(ye,{size:14})}),e.jsx("button",{onClick:()=>$(p.phone),className:"p-1 text-green-500 hover:text-green-700",title:"WhatsApp",children:e.jsx(oe,{size:14})}),e.jsx("button",{onClick:()=>z(p.phone),className:"p-1 text-blue-500 hover:text-blue-700",title:"Call",children:e.jsx(je,{size:14})})]})]}),p.alternative_contact&&e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded border mt-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Alt: "}),e.jsx("span",{className:"text-sm font-mono",children:p.alternative_contact})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>w(p.alternative_contact),className:"p-1 text-gray-500 hover:text-gray-700",title:"Copy number",children:e.jsx(ye,{size:14})}),e.jsx("button",{onClick:()=>$(p.alternative_contact),className:"p-1 text-green-500 hover:text-green-700",title:"WhatsApp",children:e.jsx(oe,{size:14})}),e.jsx("button",{onClick:()=>z(p.alternative_contact),className:"p-1 text-blue-500 hover:text-blue-700",title:"Call",children:e.jsx(je,{size:14})})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-2",children:[e.jsx("button",{onClick:()=>i(p),className:"text-gray-600 hover:text-gray-800",title:"Edit person",children:e.jsx(fe,{size:16})}),e.jsx("button",{onClick:()=>P(p.id,p.name),className:"text-red-600 hover:text-red-800",title:"Delete person",children:e.jsx(Le,{size:16})})]})]}),_.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Fe,{size:14,className:"text-blue-600"}),e.jsxs("h4",{className:"text-sm font-medium text-gray-600",children:["Connected Properties (",_.length,")"]})]}),e.jsx("div",{className:"space-y-2",children:_.map(({property:k,connection:b})=>k&&e.jsx("div",{className:"bg-gray-50 p-3 rounded-md text-sm cursor-pointer hover:bg-gray-100 border",onClick:()=>{a(k),n(!0)},children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 mb-1",children:k.area}),e.jsxs("div",{className:"flex items-center text-gray-600 mb-1",children:[e.jsx(ee,{size:12,className:"mr-1 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:k.zone||"Unknown Zone"})]}),b.role&&e.jsxs("div",{className:"text-blue-600 font-medium text-xs",children:["Role: ",b.role]}),b.remark&&e.jsxs("div",{className:"text-gray-500 text-xs mt-1 italic",children:["Note: ",b.remark]})]}),e.jsxs("div",{className:"text-blue-600 font-medium ml-2 flex-shrink-0",children:["",X(k.price_min)]})]})},k.id))})]})]},p.id)})}),L>1&&e.jsx("div",{className:"p-4 border-t bg-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:()=>u(p=>Math.max(1,p-1)),disabled:x===1,className:"px-3 py-1 rounded-md border disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(lt,{size:16})}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",x," of ",L]}),e.jsx("button",{onClick:()=>u(p=>Math.min(L,p+1)),disabled:x===L,className:"px-3 py-1 rounded-md border disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(ct,{size:16})})]})})]}),e.jsx(Qe,{isOpen:!!g,title:"Delete Person",message:`Are you sure you want to delete "${g==null?void 0:g.name}"? This will permanently remove the person and all their property connections. This action cannot be undone.`,confirmText:"Delete Person",onConfirm:f,onCancel:()=>h(null),type:"danger"})]})},ks=()=>{const{isSidebarOpen:t,toggleSidebar:r,filters:s,updateFilters:a,personFilters:n,updatePersonFilters:i,isMobileView:l,toggleFilterDrawer:c,activeTab:x,loadProperties:u,loadAllData:g}=G();y.useEffect(()=>{t&&(x==="properties"?(console.log("Loading properties for properties tab"),u()):x==="persons"&&(console.log("Loading all data for persons tab"),g()))},[t,x,u,g]);const N=x==="properties"?(()=>{let S=0;return s.searchQuery.trim()&&S++,(s.priceRange[0]>0||s.priceRange[1]<1e10)&&S++,(s.sizeRange[0]>0||s.sizeRange[1]<1e4)&&S++,s.propertyTypes.length>0&&S++,s.rating!==void 0&&S++,s.tags.length>0&&S++,s.excludedTags.length>0&&S++,s.sortBy!=="newest"&&S++,s.hasLocation!==null&&S++,(s.radiusRange[0]>0||s.radiusRange[1]<5e4)&&S++,S})():(()=>{let S=0;return n.searchQuery.trim()&&S++,n.roles.length>0&&S++,n.hasProperties!==null&&S++,S})();return t?e.jsxs("aside",{className:`bg-white shadow-lg fixed z-10 transition-all duration-300 ${l?"inset-0 top-14 overflow-y-auto":"left-0 top-14 bottom-0 w-96 overflow-y-auto"}`,children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsx("div",{className:"flex items-center justify-between mb-4"}),x==="properties"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search properties, persons, connections...",className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:s.searchQuery,onChange:S=>a({searchQuery:S.target.value})}),e.jsx(se,{size:18,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),e.jsxs("button",{onClick:c,className:`mt-3 w-full flex items-center justify-center space-x-2 px-4 py-2 rounded-md transition-colors relative ${N>0?"bg-blue-100 hover:bg-blue-200 text-blue-700 border border-blue-300":"bg-gray-100 hover:bg-gray-200"}`,children:[e.jsx(Xe,{size:16}),e.jsx("span",{children:"Filters"}),N>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-blue-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium",children:N})]})]}),x==="persons"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search persons, properties, connections...",className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:n.searchQuery,onChange:S=>i({searchQuery:S.target.value})}),e.jsx(se,{size:18,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),e.jsxs("button",{onClick:c,className:`mt-3 w-full flex items-center justify-center space-x-2 px-4 py-2 rounded-md transition-colors relative ${N>0?"bg-blue-100 hover:bg-blue-200 text-blue-700 border border-blue-300":"bg-gray-100 hover:bg-gray-200"}`,children:[e.jsx(Xe,{size:16}),e.jsx("span",{children:"Filters"}),N>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-blue-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium",children:N})]})]})]}),x==="properties"?e.jsx(Ns,{}):e.jsx(ws,{})]}):null},Ce=t=>!t||typeof t.latitude!="number"||typeof t.longitude!="number"||isNaN(t.latitude)||isNaN(t.longitude)?q:t,Ps=()=>{const{filteredProperties:t,mapViewport:r,setMapViewport:s,selectedProperty:a,setSelectedProperty:n,togglePropertyDetail:i,togglePropertyForm:l,properties:c,setFilteredProperties:x,isLiveView:u,setIsLiveView:g}=G(),[h,L]=y.useState(null),[N,S]=y.useState(()=>{const d=localStorage.getItem("mapSatelliteView");return d?JSON.parse(d):!0}),[R,E]=y.useState(null),[w,$]=y.useState(null);y.useEffect(()=>{localStorage.setItem("mapSatelliteView",JSON.stringify(N))},[N]);const z=y.useMemo(()=>t.filter(d=>{const F=Ce(d.location);return F.latitude!==q.latitude||F.longitude!==q.longitude||d.location&&typeof d.location.latitude=="number"&&typeof d.location.longitude=="number"&&!isNaN(d.location.latitude)&&!isNaN(d.location.longitude)}),[t]),P=y.useCallback(d=>{console.log("Map loaded, setting initial bounds from map.getBounds()");const F=d.target;if(F&&typeof F.getBounds=="function")try{const I=F.getBounds();I&&typeof I.getNorth=="function"&&s({bounds:I})}catch(I){console.warn("Error getting map bounds on load:",I)}},[s]),f=y.useCallback(({viewState:d,target:F})=>{let I;if(F&&typeof F.getBounds=="function")try{const V=F.getBounds();V&&typeof V.getNorth=="function"&&(I=V)}catch(V){console.warn("Error getting map bounds on move:",V)}d&&typeof d.latitude=="number"&&typeof d.longitude=="number"&&typeof d.zoom=="number"&&!isNaN(d.latitude)&&!isNaN(d.longitude)&&!isNaN(d.zoom)&&s({latitude:d.latitude,longitude:d.longitude,zoom:d.zoom,bounds:I})},[s]),p=y.useCallback(d=>{!d||!d.originalEvent||d.originalEvent.target&&(d.originalEvent.target.closest(".maplibregl-marker")||d.originalEvent.target.closest("button"))||(L(null),n(null),i(!1))},[n,i]),_=d=>{if(d.stopPropagation(),"geolocation"in navigator){if(navigator.geolocation.getCurrentPosition(F=>{const{latitude:I,longitude:V}=F.coords;!isNaN(I)&&!isNaN(V)&&(E({latitude:I,longitude:V}),s({latitude:I,longitude:V,zoom:16}))},F=>{console.error("Error getting location:",F),alert("Unable to get your location. Please check your GPS settings and try again.")},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0}),!w){const F=navigator.geolocation.watchPosition(I=>{const{latitude:V,longitude:Y}=I.coords;!isNaN(V)&&!isNaN(Y)&&E({latitude:V,longitude:Y})},I=>{console.error("Error watching position:",I)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0});$(F)}}else alert("GPS is not supported in your browser")};y.useEffect(()=>()=>{w&&navigator.geolocation.clearWatch(w)},[w]);const k=d=>Yt[d.type]||"#6B7280",b=d=>({"Plot Residential":Ue,Shop:Bt,House:Ot,Colony:_t,Flats:Fe,"Agriculture Land":Ht,"Free Zone Land":qt,Godown:Gt,Factory:Tt,"Big Commercial":Vt,"Plot Industrial":Wt,Other:Et})[d.type]||ee,U=()=>{const d=r.zoom;return d<10?24:d<12?28:d<14?32:36},Z=y.useMemo(()=>({version:8,sources:{osm:{type:"raster",tiles:[N?K.satelliteUrl:K.streetUrl],tileSize:256,attribution:N?" Esri":" OpenStreetMap contributors"}},layers:[{id:"osm",type:"raster",source:"osm",minzoom:0,maxzoom:19}]}),[N]),O=y.useMemo(()=>{const d={...r};(typeof d.latitude!="number"||typeof d.longitude!="number"||isNaN(d.latitude)||isNaN(d.longitude))&&(d.latitude=q.latitude,d.longitude=q.longitude),(typeof d.zoom!="number"||isNaN(d.zoom))&&(d.zoom=12);const{bounds:F,...I}=d;return console.log("MapView rendering with safeMapViewport:",I),I},[r]),o=d=>{const{latitude:F,longitude:I}=d.location,V=`https://www.google.com/maps/dir/?api=1&destination=${F},${I}`;window.open(V,"_blank")},C=d=>!d||d===0?null:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("span",{className:"text-xs font-medium",children:[d,"/5"]})]}),B=d=>{if(!d.radius||d.radius===0)return null;const F=Je([d.location.longitude,d.location.latitude]),I={steps:64,units:"meters"};return yt(F,d.radius,I)};return e.jsx("div",{className:"relative w-full h-full",children:e.jsxs(rt,{...O,style:{width:"100%",height:"100%"},mapStyle:Z,onLoad:P,onMove:f,onClick:p,attributionControl:!0,mapLib:at,minZoom:K.minZoom,maxZoom:K.maxZoom,children:[z.map(d=>{const F=B(d);if(!F)return null;const I=(a==null?void 0:a.id)===d.id,V=k(d);return e.jsxs(ot,{type:"geojson",data:F,children:[e.jsx(ze,{id:`radius-fill-${d.id}`,type:"fill",paint:{"fill-color":V,"fill-opacity":I?.25:.15}}),e.jsx(ze,{id:`radius-border-${d.id}`,type:"line",paint:{"line-color":V,"line-width":I?3:2,"line-opacity":I?.8:.6,"line-dasharray":I?[1,0]:[2,2]}})]},`radius-${d.id}`)}),z.map(d=>{const F=Ce(d.location),I=b(d),V=U(),Y=(a==null?void 0:a.id)===d.id;return e.jsx(Me,{longitude:F.longitude,latitude:F.latitude,anchor:"center",onClick:de=>{de.originalEvent.stopPropagation(),L(d)},children:e.jsx("div",{className:`flex items-center justify-center rounded-full border-3 transition-all cursor-pointer shadow-lg ${Y?"scale-125 border-white shadow-xl animate-pulse ring-4 ring-white ring-opacity-50":"border-white shadow-md hover:scale-110 hover:shadow-xl"}`,style:{backgroundColor:k(d),width:V,height:V,borderWidth:"3px"},children:e.jsx(I,{size:V*.55,color:"white",fill:"white",fillOpacity:1,strokeWidth:1.5})})},d.id)}),R&&e.jsx(Me,{longitude:R.longitude,latitude:R.latitude,anchor:"center",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-full border-2 border-white shadow-lg animate-pulse"}),e.jsx("div",{className:"absolute -inset-1 bg-blue-500 rounded-full opacity-20 animate-ping"})]})}),h&&e.jsx(Ct,{longitude:Ce(h.location).longitude,latitude:Ce(h.location).latitude,anchor:"bottom",onClose:()=>L(null),closeButton:!1,closeOnClick:!1,className:"rounded-lg overflow-hidden",maxWidth:"320px",children:e.jsxs("div",{className:"p-1 bg-white",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:h.type||"Property"}),h.rating>0&&C(h.rating)]}),e.jsx("h3",{className:"font-semibold text-gray-900 text-sm leading-tight",children:h.area||"Property Area"})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"text-lg font-bold text-blue-600 flex items-center",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:X(h.price_min)}),h.price_min!==h.price_max&&e.jsxs("span",{className:"text-sm font-normal text-gray-600 ml-1",children:["- ",X(h.price_max)]})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Size: "}),h.size_min===h.size_max?`${Math.round(h.size_min)} sq.yd`:`${Math.round(h.size_min)} - ${Math.round(h.size_max)} sq.yd`]})}),h.zone&&e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Zone: "}),h.zone]})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{className:"flex-1 text-xs bg-blue-500 hover:bg-blue-600 text-white py-2 px-3 rounded transition-colors flex items-center justify-center space-x-1",onClick:d=>{d.stopPropagation(),n(h),i(!0)},children:[e.jsx(Te,{size:12}),e.jsx("span",{children:"Details"})]}),e.jsxs("button",{className:"flex-1 text-xs bg-green-500 hover:bg-green-600 text-white py-2 px-3 rounded transition-colors flex items-center justify-center space-x-1",onClick:d=>{d.stopPropagation(),o(h)},children:[e.jsx(Ze,{size:12}),e.jsx("span",{children:"Navigate"})]})]})]})}),e.jsx(nt,{position:"bottom-right"}),e.jsx("div",{className:"absolute top-4 left-4 bg-white rounded-md shadow-md p-2",children:e.jsxs("button",{onClick:d=>{d.stopPropagation(),g(!u)},className:`flex items-center space-x-2 px-3 py-1.5 rounded-md transition-colors ${u?"bg-blue-50 text-blue-600":"hover:bg-gray-100"}`,title:u?"Live view enabled":"Live view disabled",children:[e.jsx(Ft,{size:18,className:u?"text-blue-600":"text-gray-600"}),e.jsx("span",{className:"text-sm",children:"Live View"})]})}),e.jsxs("div",{className:"absolute top-4 right-4 bg-white rounded-md shadow-md p-1 flex flex-col space-y-1",children:[e.jsx("button",{onClick:d=>{d.stopPropagation(),s({latitude:q.latitude,longitude:q.longitude,zoom:12})},className:"p-2 hover:bg-gray-100 rounded-md transition-colors",title:"Center on Karnal",children:e.jsx(Ue,{size:18})}),e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-md transition-colors",onClick:d=>{d.stopPropagation(),S(!N)},title:N?"Switch to Street View":"Switch to Satellite View",children:N?e.jsx(xt,{size:18}):e.jsx(mt,{size:18})})]}),e.jsx("div",{className:"absolute bottom-4 left-4 bg-white rounded-md shadow-md p-1",children:e.jsx("button",{onClick:_,className:"p-2 hover:bg-gray-100 rounded-md transition-colors",title:"Use current location",children:e.jsx(dt,{size:18})})})]})})},vt=({person:t,onClose:r})=>{const{createPerson:s,updatePerson:a,loadingStates:n}=G(),[i,l]=y.useState(t||{name:"",phone:"",role:"Owner"}),c=n.creating||n.updating,x=async u=>{if(u.preventDefault(),!c)try{if(t)await a(i);else{const{id:g,...h}=i;await s(h)}r()}catch(g){console.error("Failed to save person:",g)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-md",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t?v.buttons.editPerson:v.buttons.addPerson}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-full",disabled:c,children:e.jsx(J,{size:20})})]}),e.jsxs("form",{onSubmit:x,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:v.labels.name}),e.jsx("input",{type:"text",value:i.name||"",onChange:u=>l({...i,name:u.target.value}),className:"w-full border rounded-md p-2",placeholder:v.placeholders.person.name,required:!0,disabled:c})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:v.labels.phone}),e.jsx("input",{type:"tel",value:i.phone||"",onChange:u=>l({...i,phone:u.target.value}),className:"w-full border rounded-md p-2",placeholder:v.placeholders.person.phone,required:!0,disabled:c})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:v.labels.alternativeContact}),e.jsx("input",{type:"tel",value:i.alternative_contact||"",onChange:u=>l({...i,alternative_contact:u.target.value}),className:"w-full border rounded-md p-2",placeholder:v.placeholders.person.alternativeContact,disabled:c})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:v.labels.role}),e.jsxs("select",{value:i.role||"",onChange:u=>l({...i,role:u.target.value}),className:"w-full border rounded-md p-2",required:!0,disabled:c,children:[e.jsx("option",{value:"",children:"Select a role"}),ht.map(u=>e.jsx("option",{value:u,children:u},u))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:v.labels.about}),e.jsx("textarea",{value:i.about||"",onChange:u=>l({...i,about:u.target.value}),className:"w-full border rounded-md p-2",rows:3,placeholder:v.placeholders.person.about,disabled:c})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border rounded-md hover:bg-gray-50",disabled:c,children:v.buttons.cancel}),e.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",disabled:c,children:[c&&e.jsx(ce,{size:16,className:"animate-spin"}),e.jsx("span",{children:t?v.buttons.updatePerson:v.buttons.addPerson})]})]})]})]})})},Ss=({propertyId:t,person:r,onClose:s})=>{const{createConnection:a,loadingStates:n}=G(),[i,l]=y.useState("Contact Person"),[c,x]=y.useState(""),u=n.creating,g=async h=>{if(h.preventDefault(),u)return;const L={property_id:t,person_id:r.id,role:i,remark:c.trim()||void 0};try{await a(L),s()}catch(N){console.error("Failed to create connection:",N)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-md",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:v.buttons.connectPerson}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-full",disabled:u,children:e.jsx(J,{size:20})})]}),e.jsxs("form",{onSubmit:g,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Person Details"}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"font-medium",children:r.name}),e.jsx("div",{className:"text-sm text-gray-600",children:r.phone}),r.role&&e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["Role: ",r.role]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:v.labels.roleInProperty}),e.jsx("select",{value:i,onChange:h=>l(h.target.value),className:"w-full border rounded-md p-2",required:!0,disabled:u,children:Qt.map(h=>e.jsx("option",{value:h,children:h},h))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:v.labels.remarks}),e.jsx("textarea",{value:c,onChange:h=>x(h.target.value),className:"w-full border rounded-md p-2",rows:3,placeholder:"Add any additional notes or remarks",disabled:u})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 border rounded-md hover:bg-gray-50",disabled:u,children:v.buttons.cancel}),e.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",disabled:u,children:[u&&e.jsx(ce,{size:16,className:"animate-spin"}),e.jsx("span",{children:v.buttons.connectPerson})]})]})]})]})})},Cs=({propertyId:t,onClose:r})=>{const{persons:s,connections:a,properties:n,loadAllData:i}=G(),[l,c]=y.useState(""),[x,u]=y.useState(!1),[g,h]=y.useState(null),[L,N]=y.useState(!1);y.useEffect(()=>{(async()=>{N(!0);try{await i()}catch(f){console.error("Failed to load data for person selection:",f)}finally{N(!1)}})()},[i]);const R=[...s].sort((P,f)=>Number(f.id)-Number(P.id)).filter(P=>(P.name??"").toLowerCase().includes(l.toLowerCase())||(P.phone??"").includes(l)||(P.alternative_contact??"").includes(l)||(P.about??"").toLowerCase().includes(l.toLowerCase())||(P.role??"").toLowerCase().includes(l.toLowerCase())),E=P=>a.filter(p=>p.person_id===P).map(p=>{const _=n.find(k=>k.id===p.property_id);return _?{property:_,connection:p}:null}).filter(Boolean),w=P=>{navigator.clipboard.writeText(P)},$=P=>{const p=`https://wa.me/91${P.replace(/\D/g,"")}`;window.open(p,"_blank")},z=P=>{window.location.href=`tel:${P}`};return L?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[50] flex items-center justify-center",children:e.jsx("div",{className:"bg-white rounded-lg p-8",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"}),e.jsx("span",{children:"Loading persons..."})]})})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[50] flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Select Person"}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(J,{size:20})})]}),e.jsxs("div",{className:"p-4 border-b",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{type:"text",placeholder:"Search by name, phone, role, or about...",value:l,onChange:P=>c(P.target.value),className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx(se,{size:18,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),e.jsxs("button",{onClick:()=>u(!0),className:"w-full flex items-center justify-center space-x-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-md transition-colors",children:[e.jsx(le,{size:18}),e.jsx("span",{children:"Add New Person"})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto divide-y",children:[R.map(P=>{const f=E(P.id);return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-full flex-shrink-0",children:e.jsx(_e,{size:20,className:"text-gray-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900",children:P.name??"Unknown"}),P.role&&e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:P.role}),P.about&&e.jsx("div",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:P.about}),f.length>0&&e.jsxs("div",{className:"flex items-center text-xs text-blue-600 mb-2",children:[e.jsx(Fe,{size:12,className:"mr-1"}),e.jsxs("span",{children:[f.length," connected propert",f.length===1?"y":"ies"]})]})]})]}),e.jsx("button",{onClick:()=>h(P),className:"px-3 py-1 bg-blue-500 text-white text-sm rounded hover:bg-blue-600 flex-shrink-0 ml-2",children:"Select"})]}),P.phone&&e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded border mb-2",children:[e.jsx("span",{className:"text-sm font-mono",children:P.phone}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:p=>{p.stopPropagation(),w(P.phone)},className:"p-1 text-gray-500 hover:text-gray-700",title:"Copy number",children:e.jsx(ye,{size:14})}),e.jsx("button",{onClick:p=>{p.stopPropagation(),$(P.phone)},className:"p-1 text-green-500 hover:text-green-700",title:"WhatsApp",children:e.jsx(oe,{size:14})}),e.jsx("button",{onClick:p=>{p.stopPropagation(),z(P.phone)},className:"p-1 text-blue-500 hover:text-blue-700",title:"Call",children:e.jsx(je,{size:14})})]})]}),P.alternative_contact&&e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded border mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Alt: "}),e.jsx("span",{className:"text-sm font-mono",children:P.alternative_contact})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:p=>{p.stopPropagation(),w(P.alternative_contact)},className:"p-1 text-gray-500 hover:text-gray-700",title:"Copy number",children:e.jsx(ye,{size:14})}),e.jsx("button",{onClick:p=>{p.stopPropagation(),$(P.alternative_contact)},className:"p-1 text-green-500 hover:text-green-700",title:"WhatsApp",children:e.jsx(oe,{size:14})}),e.jsx("button",{onClick:p=>{p.stopPropagation(),z(P.alternative_contact)},className:"p-1 text-blue-500 hover:text-blue-700",title:"Call",children:e.jsx(je,{size:14})})]})]}),f.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("h4",{className:"text-xs font-medium text-gray-600 mb-2",children:"Connected Properties:"}),e.jsxs("div",{className:"space-y-1 max-h-24 overflow-y-auto",children:[f.slice(0,2).map(({property:p,connection:_})=>p&&e.jsx("div",{className:"bg-blue-50 p-2 rounded text-xs",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:p.area}),e.jsxs("div",{className:"flex items-center text-gray-600 mt-1",children:[e.jsx(ee,{size:10,className:"mr-1 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:p.zone||"Unknown Zone"})]}),_.role&&e.jsxs("div",{className:"text-blue-600 font-medium",children:["Role: ",_.role]})]}),e.jsxs("div",{className:"text-blue-600 font-medium ml-2 flex-shrink-0",children:["",X(p.price_min)]})]})},p.id)),f.length>2&&e.jsxs("div",{className:"text-xs text-gray-500 text-center py-1",children:["+",f.length-2," more properties"]})]})]})]},P.id)}),R.length===0&&e.jsx("div",{className:"p-8 text-center text-gray-500",children:"No persons found matching your search"})]})]})}),x&&e.jsx(vt,{onClose:()=>u(!1)}),g&&e.jsx(Ss,{propertyId:t,person:g,onClose:()=>h(null)})]})},Ls=({isOpen:t,onClose:r,selectedTags:s,onTagsChange:a,allTags:n=[]})=>{const[i,l]=y.useState(""),[c,x]=y.useState(null),[u,g]=y.useState(""),h=Array.from(new Set([...Kt,...n])).sort(),L=h.filter(f=>f.toLowerCase().includes(i.toLowerCase())),N=i.trim()&&!h.some(f=>f.toLowerCase()===i.trim().toLowerCase()),S=()=>{const f=i.trim();if(f&&!h.includes(f)){const p=[...s,f];a(p),l("")}},R=f=>{const p=s.includes(f)?s.filter(_=>_!==f):[...s,f];a(p)},E=f=>{x(f),g(f)},w=()=>{const f=u.trim();if(f&&c&&f!==c){const p=s.map(_=>_===c?f:_);a(p)}x(null),g("")},$=f=>{const p=s.filter(_=>_!==f);a(p)},z=f=>{f.key==="Enter"&&(f.preventDefault(),N?S():L.length===1&&(R(L[0]),l("")))},P=f=>{l(f.target.value)};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[70] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between flex-shrink-0",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[e.jsx(Ne,{size:20,className:"mr-2"}),v.buttons.manageTags]}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(J,{size:20})})]}),e.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b bg-gray-50",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:i,onChange:P,onKeyPress:z,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Search existing tags or type to add new..."}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:N?e.jsx("button",{onClick:S,className:"p-1 text-green-600 hover:text-green-700 hover:bg-green-50 rounded transition-colors",title:"Add new tag",children:e.jsx(le,{size:18})}):e.jsx(se,{size:18,className:"text-gray-400"})})]}),N&&e.jsxs("div",{className:"mt-2 text-sm text-green-600 flex items-center",children:[e.jsx(le,{size:14,className:"mr-1"}),'Press Enter or click + to add "',i.trim(),'" as a new tag']})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[s.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center",children:[e.jsx(be,{size:16,className:"mr-2 text-green-600"}),v.labels.selectedTags," (",s.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(f=>e.jsxs("div",{className:"flex items-center space-x-1 px-3 py-2 bg-blue-100 text-blue-800 rounded-lg border border-blue-200 group",children:[c===f?e.jsx("input",{type:"text",value:u,onChange:p=>g(p.target.value),onKeyPress:p=>{p.key==="Enter"&&(p.preventDefault(),w())},onBlur:w,className:"bg-transparent border-none outline-none text-sm w-24 font-medium",autoFocus:!0}):e.jsx("span",{className:"text-sm font-medium",children:f}),e.jsxs("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>E(f),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-200 transition-colors",title:"Edit tag",children:e.jsx(fe,{size:12})}),e.jsx("button",{onClick:()=>$(f),className:"text-red-500 hover:text-red-700 p-1 rounded hover:bg-red-100 transition-colors",title:"Remove tag",children:e.jsx(J,{size:12})})]})]},f))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center",children:[e.jsx(se,{size:16,className:"mr-2"}),i?`Search Results (${L.length})`:`${v.labels.availableTags} (${L.length})`]}),L.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:L.map(f=>e.jsxs("button",{onClick:()=>R(f),className:`flex items-center space-x-1 px-3 py-2 text-sm rounded-lg border transition-all hover:scale-105 ${s.includes(f)?"bg-blue-100 text-blue-800 border-blue-200 shadow-sm":"bg-gray-50 text-gray-700 border-gray-200 hover:bg-gray-100 hover:border-gray-300"}`,children:[e.jsx("span",{children:f}),s.includes(f)&&e.jsx(be,{size:14,className:"text-blue-600"})]},f))}):i?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(se,{size:32,className:"mx-auto mb-2 text-gray-300"}),e.jsxs("p",{className:"text-sm",children:['No existing tags match "',i,'"']}),N&&e.jsx("p",{className:"text-xs mt-1",children:"Press Enter to add it as a new tag"})]}):e.jsx("p",{className:"text-gray-500 text-sm",children:v.noData.noTags})]})]})})]}),e.jsxs("div",{className:"p-4 border-t bg-gray-50 flex justify-between items-center flex-shrink-0",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[s.length," tag",s.length!==1?"s":""," selected"]}),e.jsx("div",{className:"flex space-x-3",children:e.jsx("button",{onClick:r,className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors",children:"Done"})})]})]})}):null},zs=({propertyId:t,link:r,onClose:s})=>{var E;const{createLink:a,updateLink:n,loadingStates:i}=G(),[l,c]=y.useState({property_id:t,link:"",type:"Website",anchor:""}),[x,u]=y.useState(!0),g=i.creating||i.updating;y.useEffect(()=>{r&&c(r)},[r]);const h=w=>{if(!w.trim()){u(!0);return}try{new URL(w),u(!0)}catch{w.includes(".")&&!w.includes(" ")?u(!0):u(!1)}},L=w=>{c({...l,link:w}),h(w)},N=w=>w?!w.startsWith("http://")&&!w.startsWith("https://")&&!w.startsWith("mailto:")&&!w.startsWith("tel:")?`https://${w}`:w:"",S=async w=>{var z,P;if(w.preventDefault(),!((z=l.link)!=null&&z.trim())||g)return;const $={...l,property_id:t,link:N(l.link.trim()),anchor:((P=l.anchor)==null?void 0:P.trim())||void 0,type:l.type||"Website"};try{if(r)await n($);else{const{id:f,created_at:p,..._}=$;await a(_)}s()}catch(f){console.error("Failed to save link:",f)}},R=l.link?N(l.link):"";return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-md",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[e.jsx(qe,{size:20,className:"mr-2"}),r?v.buttons.editLink:v.buttons.addLink]}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-full",disabled:g,children:e.jsx(J,{size:20})})]}),e.jsxs("form",{onSubmit:S,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:[v.labels.url," *"]}),e.jsx("input",{type:"text",value:l.link||"",onChange:w=>L(w.target.value),className:`w-full border rounded-md p-2 ${x?"border-gray-300":"border-red-300 bg-red-50"}`,placeholder:v.placeholders.link.url,required:!0,disabled:g}),!x&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:"Please enter a valid URL"}),R&&x&&e.jsxs("div",{className:"mt-2 p-2 bg-gray-50 rounded border",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Preview:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{size:14,className:"text-blue-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-blue-600 truncate",children:R})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:v.labels.linkType}),e.jsx("select",{value:l.type||"",onChange:w=>c({...l,type:w.target.value}),className:"w-full border rounded-md p-2",disabled:g,children:Jt.map(w=>e.jsx("option",{value:w,children:w},w))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:v.labels.displayText}),e.jsx("input",{type:"text",value:l.anchor||"",onChange:w=>c({...l,anchor:w.target.value}),className:"w-full border rounded-md p-2",placeholder:v.placeholders.link.anchor,disabled:g}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"If left empty, the URL will be used as display text"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 border rounded-md hover:bg-gray-50",disabled:g,children:v.buttons.cancel}),e.jsxs("button",{type:"submit",disabled:!((E=l.link)!=null&&E.trim())||!x||g,className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[g&&e.jsx(ce,{size:16,className:"animate-spin"}),e.jsx("span",{children:r?v.buttons.updateLink:v.buttons.addLink})]})]})]})]})})},Ms=()=>{const{selectedProperty:t,setSelectedProperty:r,isPropertyDetailOpen:s,togglePropertyDetail:a,getPropertyPersons:n,getPropertyLinks:i,isMobileView:l,togglePropertyForm:c,connections:x,deleteConnection:u,deleteProperty:g,deleteLink:h,properties:L,updateProperty:N}=G(),[S,R]=y.useState(!1),[E,w]=y.useState(!1),[$,z]=y.useState(!1),[P,f]=y.useState(!1),[p,_]=y.useState(null),[k,b]=y.useState(null);if(!t||!s)return null;const U=n(t.id),Z=i(t.id),O=m=>x.find(A=>A.property_id===t.id&&A.person_id===m),o=Array.from(new Set(L.flatMap(m=>m.tags||[]))),C=()=>{if(!t.location)return!1;const{latitude:m,longitude:A}=t.location;return m!==q.latitude||A!==q.longitude},B=()=>{const{latitude:m,longitude:A}=t.location,me=`https://www.google.com/maps/dir/?api=1&destination=${m},${A}`;window.open(me,"_blank")},d=m=>{navigator.clipboard.writeText(m)},F=m=>{const me=`https://wa.me/91${m.replace(/\D/g,"")}`;window.open(me,"_blank")},I=m=>{window.location.href=`tel:${m}`},V=(m,A)=>{b({type:"connection",id:m,name:A})},Y=()=>{b({type:"property",id:t.id,name:t.area||"this property"})},de=(m,A)=>{b({type:"link",id:m,name:A||"this link"})},we=async()=>{if(k){try{if(k.type==="connection"){const m=x.find(A=>A.property_id===t.id&&A.person_id===k.id);m&&await u(m.id)}else k.type==="property"?await g(k.id):k.type==="link"&&await h(k.id)}catch(m){console.error("Failed to delete:",m)}b(null)}},ue=()=>!t.radius||t.radius===0?"Add":"Edit",Ee=async m=>{try{const A={...t,tags:m};await N(A)}catch(A){console.error("Failed to update tags:",A)}},j=m=>{window.open(m,"_blank","noopener,noreferrer")},T=m=>{switch(m){case"Website":return e.jsx(Te,{size:16});case"Social Media":return e.jsx(oe,{size:16});case"Document":return e.jsx(At,{size:16});case"Image":return e.jsx(Ne,{size:16});case"Video":return e.jsx(Ne,{size:16});case"Map":return e.jsx(ee,{size:16});default:return e.jsx(qe,{size:16})}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`bg-white shadow-xl z-30 flex flex-col ${l?"fixed inset-x-0 bottom-0 rounded-t-2xl max-h-[90vh]":"fixed top-14 right-0 bottom-0 w-1/3 border-l"}`,children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-4 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h2",{className:"text-lg font-semibold truncate flex items-center gap-1",children:[t.type||"Property",Number(t.rating)>0&&` - ${t.rating}/5`]}),e.jsx("p",{className:"text-blue-100 text-sm truncate",children:t.area||"Property"})]}),e.jsx("button",{onClick:()=>a(),className:"p-2 rounded-full hover:bg-blue-600 transition-colors ml-2 flex-shrink-0","aria-label":"Close details",children:e.jsx(J,{size:20})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[C()&&e.jsxs("button",{onClick:B,className:"flex items-center space-x-1 px-3 py-1.5 bg-white/20 hover:bg-white/30 rounded-lg transition-colors text-sm",title:"Navigate with Google Maps",children:[e.jsx(Ze,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Navigate"})]}),e.jsxs("button",{onClick:()=>w(!0),className:"flex items-center space-x-1 px-3 py-1.5 bg-white/20 hover:bg-white/30 rounded-lg transition-colors text-sm",title:"Update location",children:[e.jsx(ee,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:ue()})]}),e.jsxs("button",{onClick:()=>c(t),className:"flex items-center space-x-1 px-3 py-1.5 bg-white/20 hover:bg-white/30 rounded-lg transition-colors text-sm",title:"Edit property",children:[e.jsx(fe,{size:16}),e.jsx("span",{className:"hidden sm:inline"})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-4 rounded-xl border border-blue-100",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3 gap-4",children:[e.jsxs("div",{className:"flex-1 bg-white p-3 rounded-lg border",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Size"}),e.jsx("div",{className:"font-semibold text-gray-900",children:t.size_min===t.size_max?`${Math.round(t.size_min)} sq.yd`:`${Math.round(t.size_min)} - ${Math.round(t.size_max/9)} sq.yd`})]}),e.jsxs("div",{className:"flex-1 bg-white p-3 rounded-lg border",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Price"}),e.jsx("div",{className:"font-semibold text-gray-900",children:t.price_min===t.price_max?`${X(t.price_min)}`:`${X(t.price_min)} to ${X(t.price_max)}`})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.zone&&e.jsxs("div",{className:"bg-white p-3 rounded-lg border",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Zone"}),e.jsx("div",{className:"font-semibold text-gray-900 text-sm",children:t.zone})]}),t.radius>0&&e.jsxs("div",{className:"bg-white p-3 rounded-lg border",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Radius"}),e.jsx("div",{className:"font-semibold text-gray-900 text-sm",children:t.radius>=1e3?`${(t.radius/1e3).toFixed(1)} km`:`${t.radius} m`})]})]})]}),t.description&&e.jsxs("div",{className:"bg-white border rounded-xl p-4",children:[e.jsxs("h4",{className:"text-sm font-light mb-2 flex items-center text-gray-900",children:[e.jsx(Rt,{size:14,className:"mr-2 text-gray-500"}),"Description"]}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.description})]}),e.jsx("div",{className:"",children:t.tags.length>0?e.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.tags.map((m,A)=>e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-green-50 text-green-700 border border-green-200",children:m},A)),e.jsxs("button",{onClick:()=>z(!0),className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-gray-50 text-gray-600 border border-gray-200 gap-2",children:[e.jsx(Ye,{size:14}),e.jsx("span",{children:"Edit Tags"})]})]}):e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-2 py-1 text-gray-500",children:[e.jsx("p",{className:"text-sm",children:"No tags added yet"}),e.jsxs("button",{onClick:()=>z(!0),className:"inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200 transition gap-2",children:[e.jsx(Ye,{size:14}),e.jsx("span",{children:"Add Tags"})]})]})}),t.note&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4",children:[e.jsx("h4",{className:"text-sm font-light mb-1 text-amber-800",children:"Notes"}),e.jsx("p",{className:"text-amber-700",children:t.note})]}),e.jsxs("div",{className:"bg-white border rounded-xl p-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"text-sm font-light flex items-center text-gray-900",children:[e.jsx(qe,{size:14,className:"mr-2 text-gray-600"}),"Resource Links",e.jsx("span",{className:"ml-2 bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded-full",children:Z.length})]}),e.jsxs("button",{onClick:()=>f(!0),className:"flex items-center space-x-1 px-3 py-1.5 bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-lg transition-colors text-sm",children:[e.jsx(le,{size:14}),e.jsx("span",{children:"Add Link"})]})]}),Z.length>0?e.jsx("div",{className:"space-y-2",children:Z.map(m=>e.jsx("div",{className:"bg-gray-50 border rounded-lg p-3 hover:bg-gray-100 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("div",{className:"text-blue-600",children:T(m.type)}),e.jsx("span",{className:"text-xs text-gray-500 bg-gray-200 px-2 py-0.5 rounded",children:m.type||"Link"})]}),e.jsx("button",{onClick:()=>j(m.link),className:"text-blue-600 hover:text-blue-800 font-medium text-sm truncate block w-full text-left",title:m.link,children:m.anchor||m.link}),m.anchor&&e.jsx("div",{className:"text-xs text-gray-500 mt-1 truncate",children:m.link})]}),e.jsxs("div",{className:"flex items-center space-x-1 ml-2",children:[e.jsx("button",{onClick:()=>{_(m),f(!0)},className:"text-gray-500 hover:text-gray-700 p-1 rounded-md hover:bg-gray-200 transition-colors",title:"Edit link",children:e.jsx(fe,{size:14})}),e.jsx("button",{onClick:()=>de(m.id,m.anchor||m.link),className:"text-red-500 hover:text-red-700 p-1 rounded-md hover:bg-red-100 transition-colors",title:"Delete link",children:e.jsx(Le,{size:14})})]})]})},m.id))}):e.jsx("span",{})]}),e.jsxs("div",{className:"bg-white border rounded-xl p-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"text-sm font-light flex items-center text-gray-900",children:[e.jsx(_e,{size:14,className:"mr-2 text-gray-600"}),"Connected Persons",e.jsx("span",{className:"ml-2 bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded-full",children:U.length})]}),e.jsxs("button",{onClick:()=>R(!0),className:"flex items-center space-x-1 px-3 py-1.5 bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-lg transition-colors text-sm",children:[e.jsx(le,{size:14}),e.jsx("span",{children:"Add"})]})]}),U.length>0?e.jsx("div",{className:"space-y-4",children:U.map(m=>{const A=O(m.id);return e.jsxs("div",{className:"bg-gray-50 border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:m.name}),m.role&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Person Role: ",m.role]}),(A==null?void 0:A.role)&&e.jsxs("div",{className:"text-sm text-blue-600 font-medium",children:["Property Role: ",A.role]})]})}),e.jsx("button",{onClick:()=>V(m.id,m.name),className:"text-red-500 hover:text-red-700 p-1 rounded-md hover:bg-red-50 transition-colors",title:"Remove person from property",children:e.jsx(Le,{size:16})})]}),(A==null?void 0:A.remark)&&e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200 mb-3",children:[e.jsx("div",{className:"text-xs text-blue-600 uppercase tracking-wide mb-1",children:"Connection Notes"}),e.jsx("div",{className:"text-sm text-blue-800",children:A.remark})]}),m.about&&e.jsxs("div",{className:"bg-white p-3 rounded-lg border mb-3",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"About Person"}),e.jsx("div",{className:"text-sm text-gray-700",children:m.about})]}),m.phone&&e.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded-lg border mb-2",children:[e.jsx("span",{className:"text-sm font-mono text-gray-900",children:m.phone}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>d(m.phone),className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-md transition-colors",title:"Copy number",children:e.jsx(ye,{size:14})}),e.jsx("button",{onClick:()=>F(m.phone),className:"p-2 text-green-500 hover:text-green-700 hover:bg-green-50 rounded-md transition-colors",title:"WhatsApp",children:e.jsx(oe,{size:14})}),e.jsx("button",{onClick:()=>I(m.phone),className:"p-2 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded-md transition-colors",title:"Call",children:e.jsx(je,{size:14})})]})]}),m.alternative_contact&&e.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded-lg border mb-2",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:["Alt:"," "]}),e.jsx("span",{className:"text-sm font-mono text-gray-900",children:m.alternative_contact})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>d(m.alternative_contact),className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-md transition-colors",title:"Copy number",children:e.jsx(ye,{size:14})}),e.jsx("button",{onClick:()=>F(m.alternative_contact),className:"p-2 text-green-500 hover:text-green-700 hover:bg-green-50 rounded-md transition-colors",title:"WhatsApp",children:e.jsx(oe,{size:14})}),e.jsx("button",{onClick:()=>I(m.alternative_contact),className:"p-2 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded-md transition-colors",title:"Call",children:e.jsx(je,{size:14})})]})]})]},m.id)})}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(_e,{size:48,className:"mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No contact persons available"}),e.jsx("p",{className:"text-sm",children:"Add someone to get started"})]})]}),e.jsxs("div",{className:"bg-white border rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-sm font-light flex items-center text-gray-900",children:[e.jsx(Ze,{size:14,className:"mr-2 text-gray-600"}),"Location & Coverage"]}),e.jsxs("button",{onClick:()=>w(!0),className:"flex items-center space-x-1 px-3 py-1.5 bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-lg transition-colors text-sm",children:[e.jsx(fe,{size:14}),e.jsx("span",{children:ue()})]})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Coordinates"}),e.jsxs("div",{className:"font-mono text-sm text-gray-900",children:[t.location.latitude.toFixed(6),"N,"," ",t.location.longitude.toFixed(6),"E"]})]})})]}),e.jsxs("button",{onClick:Y,className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors font-medium shadow-sm",children:[e.jsx(Le,{size:18}),e.jsx("span",{children:"Delete Property"})]}),e.jsx("div",{className:"pb-20"})]})})]}),S&&t&&e.jsx(Cs,{propertyId:t.id,onClose:()=>R(!1)}),E&&t&&e.jsx(jt,{property:t,onClose:()=>w(!1)}),$&&t&&e.jsx(Ls,{isOpen:$,onClose:()=>z(!1),selectedTags:t.tags||[],onTagsChange:Ee,allTags:o}),P&&e.jsx(zs,{propertyId:t.id,link:p,onClose:()=>{f(!1),_(null)}}),e.jsx(Qe,{isOpen:!!k,title:(k==null?void 0:k.type)==="connection"?"Remove Person Connection":(k==null?void 0:k.type)==="property"?"Delete Property":"Delete Link",message:(k==null?void 0:k.type)==="connection"?`Are you sure you want to remove ${k.name} from this property? This action cannot be undone.`:(k==null?void 0:k.type)==="property"?`Are you sure you want to delete "${k==null?void 0:k.name}"? This will permanently remove the property and all its connections. This action cannot be undone.`:`Are you sure you want to delete the link "${k==null?void 0:k.name}"? This action cannot be undone.`,confirmText:(k==null?void 0:k.type)==="connection"?"Remove":(k==null?void 0:k.type)==="property"?"Delete Property":"Delete Link",onConfirm:we,onCancel:()=>b(null),type:"danger"})]})},Nt=()=>{const{filters:t,updateFilters:r,resetFilters:s,getAllTags:a,properties:n}=G(),[i,l]=y.useState(""),[c,x]=y.useState(""),[u,g]=y.useState(!1),[h,L]=y.useState(!1),[N,S]=y.useState(!1),[R,E]=y.useState(!1),[w,$]=y.useState(!1),z=a(),P=o=>{const C=[...t.propertyTypes],B=C.indexOf(o);B===-1?C.push(o):C.splice(B,1),r({propertyTypes:C})},f=o=>{const C=[...t.tags],B=C.indexOf(o);B===-1?C.push(o):C.splice(B,1),r({tags:C})},p=o=>{const C=[...t.excludedTags],B=C.indexOf(o);B===-1?C.push(o):C.splice(B,1),r({excludedTags:C})},_=o=>{r({hasLocation:o})},k=z.filter(o=>o.toLowerCase().includes(i.toLowerCase())&&!t.excludedTags.includes(o)),b=z.filter(o=>o.toLowerCase().includes(c.toLowerCase())&&!t.tags.includes(o)),U=St.useMemo(()=>{const o=n.length,C=n.filter(d=>d.location.latitude!==q.latitude||d.location.longitude!==q.longitude).length,B=o-C;return{total:o,withLocation:C,withoutLocation:B}},[n]),Z=o=>o>=1e3?`${(o/1e3).toFixed(1)}km`:`${o}m`,O=o=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("span",{children:[o,"/5"]})]});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold",children:v.labels.filters}),e.jsx("button",{onClick:s,className:"text-sm text-blue-600 hover:text-blue-800",children:v.buttons.reset})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:v.labels.sortBy}),e.jsx("select",{value:t.sortBy,onChange:o=>r({sortBy:o.target.value}),className:"w-full border rounded-md p-2 text-sm",children:ss.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:v.labels.propertyTypes}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:pt.map(o=>e.jsxs("button",{className:`flex items-center w-full px-3 py-1.5 text-sm rounded-md border ${t.propertyTypes.includes(o)?"bg-blue-50 border-blue-300 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,onClick:()=>P(o),children:[e.jsx("span",{className:"flex-1 text-left",children:o}),t.propertyTypes.includes(o)&&e.jsx(be,{size:16})]},o))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:v.labels.priceRange}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Xt.map((o,C)=>e.jsxs("button",{className:`px-3 py-1.5 text-sm rounded-md border ${t.priceRange[0]===o[0]&&t.priceRange[1]===o[1]?"bg-blue-50 border-blue-300 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,onClick:()=>r({priceRange:[o[0],o[1]]}),children:[X(o[0])," -"," ",o[1]===1e8?"5+ Cr":X(o[1])]},C))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:v.labels.sizeRange}),e.jsx("button",{onClick:()=>S(!N),className:"text-blue-600 text-sm flex items-center",children:N?e.jsx(ne,{size:16}):e.jsx(ae,{size:16})})]}),N&&e.jsx("div",{className:"grid grid-cols-2 gap-2",children:es.map((o,C)=>e.jsxs("button",{className:`px-3 py-1.5 text-sm rounded-md border ${t.sizeRange[0]===o[0]&&t.sizeRange[1]===o[1]?"bg-blue-50 border-blue-300 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,onClick:()=>r({sizeRange:[o[0],o[1]]}),children:[Math.round(o[0]/9)," -"," ",o[1]===1e4?"1000+":Math.round(o[1]/9)," yd"]},C))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:v.labels.rating}),e.jsx("button",{onClick:()=>E(!R),className:"text-blue-600 text-sm flex items-center",children:R?e.jsx(ne,{size:16}):e.jsx(ae,{size:16})})]}),R&&e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("button",{className:`px-3 py-1.5 text-sm rounded-md border ${t.rating===void 0?"bg-blue-50 border-blue-300 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,onClick:()=>r({rating:void 0}),children:"Any"}),gt.slice(2).map(o=>e.jsxs("button",{className:`px-3 py-1.5 text-sm rounded-md border flex items-center justify-center space-x-1 ${t.rating===o?"bg-blue-50 border-blue-300 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,onClick:()=>r({rating:o}),children:[e.jsxs("span",{children:[o,"+"]}),O(o)]},o))]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center",children:[e.jsx(Ne,{size:16,className:"mr-1 text-green-600"}),v.labels.includeTags,t.tags.length>0&&e.jsx("span",{className:"ml-2 bg-green-100 text-green-800 text-xs px-2 py-0.5 rounded-full",children:t.tags.length})]}),e.jsx("button",{onClick:()=>g(!u),className:"text-blue-600 text-sm flex items-center",children:u?e.jsx(ne,{size:16}):e.jsx(ae,{size:16})})]}),t.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:t.tags.map(o=>e.jsxs("button",{onClick:()=>f(o),className:"inline-flex items-center px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs hover:bg-green-200 transition-colors",children:[e.jsx("span",{children:o}),e.jsx(J,{size:12,className:"ml-1"})]},o))}),u&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search tags to include...",value:i,onChange:o=>l(o.target.value),className:"w-full px-3 py-2 pr-8 border rounded-md text-sm"}),e.jsx(se,{size:16,className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),e.jsxs("div",{className:"max-h-32 overflow-y-auto space-y-1",children:[k.map(o=>e.jsxs("button",{className:`flex items-center w-full px-3 py-1.5 text-sm rounded-md border ${t.tags.includes(o)?"bg-green-50 border-green-300 text-green-700":"border-gray-300 hover:bg-gray-50"}`,onClick:()=>f(o),children:[e.jsx("span",{className:"flex-1 text-left",children:o}),t.tags.includes(o)&&e.jsx(be,{size:16})]},o)),k.length===0&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-2",children:"No tags found"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center",children:[e.jsx($t,{size:16,className:"mr-1 text-red-600"}),v.labels.excludeTags,t.excludedTags.length>0&&e.jsx("span",{className:"ml-2 bg-red-100 text-red-800 text-xs px-2 py-0.5 rounded-full",children:t.excludedTags.length})]}),e.jsx("button",{onClick:()=>L(!h),className:"text-blue-600 text-sm flex items-center",children:h?e.jsx(ne,{size:16}):e.jsx(ae,{size:16})})]}),t.excludedTags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:t.excludedTags.map(o=>e.jsxs("button",{onClick:()=>p(o),className:"inline-flex items-center px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs hover:bg-red-200 transition-colors",children:[e.jsx("span",{children:o}),e.jsx(J,{size:12,className:"ml-1"})]},o))}),h&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search tags to exclude...",value:c,onChange:o=>x(o.target.value),className:"w-full px-3 py-2 pr-8 border rounded-md text-sm"}),e.jsx(se,{size:16,className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),e.jsxs("div",{className:"max-h-32 overflow-y-auto space-y-1",children:[b.map(o=>e.jsxs("button",{className:`flex items-center w-full px-3 py-1.5 text-sm rounded-md border ${t.excludedTags.includes(o)?"bg-red-50 border-red-300 text-red-700":"border-gray-300 hover:bg-gray-50"}`,onClick:()=>p(o),children:[e.jsx("span",{className:"flex-1 text-left",children:o}),t.excludedTags.includes(o)&&e.jsx(be,{size:16})]},o)),b.length===0&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-2",children:"No tags found"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium mb-2 flex items-center",children:[e.jsx(ee,{size:16,className:"mr-1 text-blue-600"}),v.labels.hasLocation]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("button",{className:`px-3 py-1.5 text-sm rounded-md border ${t.hasLocation===null?"bg-blue-50 border-blue-300 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,onClick:()=>_(null),children:"All"}),e.jsx("button",{className:`px-3 py-1.5 text-sm rounded-md border ${t.hasLocation===!0?"bg-green-50 border-green-300 text-green-700":"border-gray-300 hover:bg-gray-50"}`,onClick:()=>_(!0),children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{children:"Added"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",U.withLocation,")"]})]})}),e.jsx("button",{className:`px-3 py-1.5 text-sm rounded-md border ${t.hasLocation===!1?"bg-orange-50 border-orange-300 text-orange-700":"border-gray-300 hover:bg-gray-50"}`,onClick:()=>_(!1),children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{children:"Missing"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",U.withoutLocation,")"]})]})})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center",children:[e.jsx(Ut,{size:16,className:"mr-1 text-purple-600"}),v.labels.radiusRange]}),e.jsx("button",{onClick:()=>$(!w),className:"text-blue-600 text-sm flex items-center",children:w?e.jsx(ne,{size:16}):e.jsx(ae,{size:16})})]}),w&&e.jsx("div",{className:"grid grid-cols-2 gap-2",children:ts.map((o,C)=>e.jsx("button",{className:`px-3 py-1.5 text-sm rounded-md border ${t.radiusRange[0]===o[0]&&t.radiusRange[1]===o[1]?"bg-purple-50 border-purple-300 text-purple-700":"border-gray-300 hover:bg-gray-50"}`,onClick:()=>r({radiusRange:[o[0],o[1]]}),children:o[0]===0&&o[1]===0?"No Radius":`${Z(o[0])} - ${Z(o[1])}`},C))})]})]})},wt=()=>{const{personFilters:t,updatePersonFilters:r,resetPersonFilters:s}=G(),a=i=>{const l=[...t.roles],c=l.indexOf(i);c===-1?l.push(i):l.splice(c,1),r({roles:l})},n=i=>{r({hasProperties:i})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold",children:v.labels.filters}),e.jsx("button",{onClick:s,className:"text-sm text-blue-600 hover:text-blue-800",children:v.buttons.reset})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:v.labels.role}),e.jsx("div",{className:"space-y-2",children:ht.map(i=>e.jsxs("button",{className:`flex items-center w-full px-3 py-1.5 text-sm rounded-md border ${t.roles.includes(i)?"bg-blue-50 border-blue-300 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,onClick:()=>a(i),children:[e.jsx("span",{className:"flex-1 text-left",children:i}),t.roles.includes(i)&&e.jsx(be,{size:16})]},i))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:v.labels.hasProperties}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("button",{className:`px-3 py-1.5 text-sm rounded-md border ${t.hasProperties===!0?"bg-blue-50 border-blue-300 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,onClick:()=>n(!0),children:"Yes"}),e.jsx("button",{className:`px-3 py-1.5 text-sm rounded-md border ${t.hasProperties===!1?"bg-blue-50 border-blue-300 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,onClick:()=>n(!1),children:"No"}),e.jsx("button",{className:`px-3 py-1.5 text-sm rounded-md border ${t.hasProperties===null?"bg-blue-50 border-blue-300 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,onClick:()=>n(null),children:"Any"})]})]})]})},_s=()=>{const{isFilterDrawerOpen:t,toggleFilterDrawer:r,isMobileView:s,activeTab:a}=G();return!t||!s?null:e.jsx("div",{className:"fixed inset-0 z-40 bg-black bg-opacity-50",children:e.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-white rounded-t-xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-4 border-b sticky top-0 bg-white z-10 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:a==="properties"?"Property Filters":"Person Filters"}),e.jsx("button",{onClick:r,className:"p-2 rounded-md hover:bg-gray-100 transition-colors","aria-label":"Close filters",children:e.jsx(J,{size:18})})]}),e.jsx("div",{className:"p-4 pb-20",children:a==="properties"?e.jsx(Nt,{}):e.jsx(wt,{})}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white border-t",children:e.jsx("button",{onClick:r,className:"w-full py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-md transition-colors font-medium",children:"Apply Filters"})})]})})},Fs=()=>{const{isFilterDrawerOpen:t,toggleFilterDrawer:r,activeTab:s,isMobileView:a}=G();return!t||a?null:e.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between flex-shrink-0",children:[e.jsx("h2",{className:"text-lg font-semibold",children:s==="properties"?"Property Filters":"Person Filters"}),e.jsx("button",{onClick:r,className:"p-2 rounded-md hover:bg-gray-100 transition-colors","aria-label":"Close filters",children:e.jsx(J,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:s==="properties"?e.jsx(Nt,{}):e.jsx(wt,{})}),e.jsx("div",{className:"p-4 border-t bg-gray-50 flex justify-end",children:e.jsx("button",{onClick:r,className:"px-6 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-md transition-colors font-medium",children:"Apply Filters"})})]})})},Ts=({property:t,onClose:r})=>{const{createProperty:s,updateProperty:a,loadingStates:n,properties:i}=G(),l=o=>!o||typeof o.latitude!="number"||typeof o.longitude!="number"||isNaN(o.latitude)||isNaN(o.longitude)?q:o,[c,x]=y.useState(()=>{const o=t||{size_min:0,size_max:0,price_min:0,price_max:0,tags:[],rating:void 0,location:q,radius:0,area:"",zone:"",type:"Plot Residential",description:"",note:""};return{...o,location:l(o.location)}}),[u,g]=y.useState({price:!1,size:!1}),[h,L]=y.useState([]),[N,S]=y.useState(!1),[R,E]=y.useState(-1),w=y.useRef(null),$=y.useRef(null),z=n.creating||n.updating;y.useEffect(()=>{if(t){const o=l(t.location),C={...t,location:o};x(C)}else x({size_min:0,size_max:0,price_min:0,price_max:0,tags:[],rating:void 0,location:q,radius:0,area:"",zone:"",type:"Plot Residential",description:"",note:""})},[t]);const P=y.useCallback(()=>{const o=i.map(C=>C.area).filter(C=>C&&C.trim()!=="").map(C=>C.trim());return Array.from(new Set(o)).sort()},[i]),f=y.useCallback(o=>o.trim()?P().filter(d=>d.toLowerCase().includes(o.toLowerCase())).slice(0,10):[],[P]),p=o=>{if(x({...c,area:o}),o.trim()){const C=f(o);L(C),S(C.length>0)}else L([]),S(!1);E(-1)},_=()=>{const o=c.area||"";if(o.trim()){const C=f(o);L(C),S(C.length>0)}else{const C=P().slice(0,10);L(C),S(C.length>0)}E(-1)},k=()=>{setTimeout(()=>{S(!1),E(-1)},150)},b=o=>{var C;if(!(!N||h.length===0))switch(o.key){case"ArrowDown":o.preventDefault(),E(B=>B<h.length-1?B+1:0);break;case"ArrowUp":o.preventDefault(),E(B=>B>0?B-1:h.length-1);break;case"Enter":if(o.preventDefault(),R>=0){const B=h[R];x({...c,area:B}),S(!1),E(-1)}break;case"Escape":S(!1),E(-1),(C=w.current)==null||C.blur();break}},U=o=>{var C;x({...c,area:o}),S(!1),E(-1),(C=w.current)==null||C.focus()},Z=async o=>{if(o.preventDefault(),z)return;const C=c.price_min||0,B=u.price?c.price_max||0:C,d=c.size_min||0,F=u.size?c.size_max||0:d,I=l(c.location),V={...c,price_min:C,price_max:B,size_min:d,size_max:F,radius:c.radius||0,location:I,rating:c.rating||0};try{if(t)await a(V);else{const{id:Y,created_on:de,updated_on:we,...ue}=V;await s(ue)}r()}catch(Y){console.error("Failed to save property:",Y)}},O=()=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>x({...c,rating:void 0}),className:`px-3 py-2 text-sm rounded-md border transition-colors ${c.rating===void 0?"bg-gray-100 border-gray-300 text-gray-700":"border-gray-300 hover:bg-gray-50"}`,disabled:z,children:"None"}),gt.map(o=>e.jsx("button",{type:"button",onClick:()=>x({...c,rating:o}),className:`px-3 py-2 text-sm rounded-md border transition-colors ${c.rating===o?"bg-blue-100 border-blue-300 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,disabled:z,children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("span",{children:[o,"/5"]})]})},o))]});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between sticky top-0 bg-white z-10",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t?v.buttons.editProperty:v.buttons.addProperty}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-full",disabled:z,children:e.jsx(J,{size:20})})]}),e.jsxs("form",{onSubmit:Z,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:v.labels.propertyType}),e.jsxs("select",{value:c.type||"",onChange:o=>x({...c,type:o.target.value}),className:"w-full border rounded-md p-2",required:!0,disabled:z,children:[e.jsx("option",{value:"",children:"Select property type"}),pt.map(o=>e.jsx("option",{value:o,children:o},o))]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:v.labels.area}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:w,type:"text",value:c.area||"",onChange:o=>p(o.target.value),onFocus:_,onBlur:k,onKeyDown:b,className:"w-full border rounded-md p-2 pr-8",placeholder:v.placeholders.property.area,required:!0,disabled:z,autoComplete:"off"}),e.jsx(ee,{size:16,className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),N&&h.length>0&&e.jsx("div",{ref:$,className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:h.map((o,C)=>e.jsx("button",{type:"button",onClick:()=>U(o),className:`w-full text-left px-3 py-2 hover:bg-gray-100 transition-colors ${C===R?"bg-blue-50 text-blue-700":"text-gray-900"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ee,{size:14,className:"text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:o})]})},o))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:v.labels.zone}),e.jsxs("select",{value:c.zone||"",onChange:o=>x({...c,zone:o.target.value}),className:"w-full border rounded-md p-2",disabled:z,children:[e.jsx("option",{value:"",children:"Select zone"}),Ge.map(o=>e.jsx("option",{value:o,children:o},o))]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("label",{className:"block text-sm font-medium",children:[v.labels.size," (in Sq. Yards)"]}),e.jsx("button",{type:"button",onClick:()=>g(o=>({...o,size:!o.size})),className:"text-blue-600 text-sm flex items-center",disabled:z,children:u.size?e.jsxs(e.Fragment,{children:[e.jsx(ne,{size:16}),e.jsx("span",{children:v.buttons.hideRange})]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{size:16}),e.jsx("span",{children:v.buttons.showRange})]})})]}),e.jsxs("div",{className:`grid ${u.size?"grid-cols-2 gap-4":"grid-cols-1"}`,children:[e.jsx("input",{type:"number",value:c.size_min?c.size_min:"",onChange:o=>x({...c,size_min:Number(o.target.value)}),className:"w-full border rounded-md p-2",placeholder:u.size?"Min Size":"Size",required:!0,disabled:z}),u.size&&e.jsx("input",{type:"number",value:c.size_max?c.size_max:"",onChange:o=>x({...c,size_max:Number(o.target.value)}),className:"w-full border rounded-md p-2",placeholder:"Max Size",required:!0,disabled:z})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("label",{className:"block text-sm font-medium",children:[v.labels.price," (in Lakhs)"]}),e.jsx("button",{type:"button",onClick:()=>g(o=>({...o,price:!o.price})),className:"text-blue-600 text-sm flex items-center",disabled:z,children:u.price?e.jsxs(e.Fragment,{children:[e.jsx(ne,{size:16}),e.jsx("span",{children:v.buttons.hideRange})]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{size:16}),e.jsx("span",{children:v.buttons.showRange})]})})]}),e.jsxs("div",{className:`grid ${u.price?"grid-cols-2 gap-4":"grid-cols-1"}`,children:[e.jsx("input",{type:"number",value:c.price_min?c.price_min:"",onChange:o=>x({...c,price_min:Number(o.target.value)}),className:"w-full border rounded-md p-2",placeholder:u.price?"Min Price":"Price",required:!0,disabled:z}),u.price&&e.jsx("input",{type:"number",value:c.price_max?c.price_max:"",onChange:o=>x({...c,price_max:Number(o.target.value)}),className:"w-full border rounded-md p-2",placeholder:"Max Price",required:!0,disabled:z})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:v.labels.rating}),O()]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:v.labels.description}),e.jsx("textarea",{value:c.description||"",onChange:o=>x({...c,description:o.target.value}),className:"w-full border rounded-md p-2",rows:3,placeholder:v.placeholders.property.description,disabled:z})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:v.labels.notes}),e.jsx("textarea",{value:c.note||"",onChange:o=>x({...c,note:o.target.value}),className:"w-full border rounded-md p-2",rows:2,placeholder:v.placeholders.property.notes,disabled:z})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border rounded-md hover:bg-gray-50",disabled:z,children:v.buttons.cancel}),e.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",disabled:z,children:[z&&e.jsx(ce,{size:16,className:"animate-spin"}),e.jsx("span",{children:t?v.buttons.updateProperty:v.buttons.addProperty})]})]})]})]})})};function As(){const{isSidebarOpen:t,isMobileView:r,setMobileView:s,showPropertyForm:a,showPersonForm:n,togglePropertyForm:i,togglePersonForm:l,editingProperty:c,editingPerson:x,loadProperties:u,isLoading:g,error:h,activeTab:L}=G(),N=y.useRef(!1);return y.useEffect(()=>{const S=()=>{s(window.innerWidth<768)};return S(),window.addEventListener("resize",S),()=>{window.removeEventListener("resize",S)}},[s]),y.useEffect(()=>{N.current||(N.current=!0,console.log("App initializing - loading only properties initially"),u())},[u]),g&&!N.current?e.jsx("div",{className:"h-screen w-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading properties..."})]})}):h?e.jsx("div",{className:"h-screen w-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 mb-4",children:e.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("p",{className:"text-red-600 mb-4",children:h}),e.jsx("button",{onClick:()=>{N.current=!1,u()},className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:"Retry"})]})}):e.jsxs("div",{className:"h-screen w-screen overflow-hidden bg-gray-50",children:[e.jsx(gs,{}),e.jsxs("div",{className:"flex h-full pt-14",children:[e.jsx(ks,{}),e.jsx("main",{className:`flex-1 transition-all duration-300 ${t&&!r?"ml-96":""}`,children:e.jsx(Ps,{})}),e.jsx(Ms,{}),e.jsx(_s,{}),e.jsx(Fs,{}),a&&e.jsx(Ts,{property:c,onClose:()=>i()}),n&&e.jsx(vt,{person:x,onClose:()=>l()})]})]})}it(document.getElementById("root")).render(e.jsx(y.StrictMode,{children:e.jsx(As,{})}));
